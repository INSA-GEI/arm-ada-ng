<!DOCTYPE html>
<!-- saved from url=(0079)http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/ -->
<html class="js" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="profile" href="http://gmpg.org/xfn/11">
  <link rel="pingback" href="http://www.lucadavidian.com/xmlrpc.php">

  <title>STM32: using the LTDC display controller – hello world</title>
<script>document.documentElement.className = document.documentElement.className.replace("no-js","js");</script>
<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="hello world » Feed" href="http://www.lucadavidian.com/feed/">
<link rel="alternate" type="application/rss+xml" title="hello world » Comments Feed" href="http://www.lucadavidian.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="hello world » STM32: using the LTDC display controller Comments Feed" href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.lucadavidian.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.6"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56692,8205,9792,65039],[55357,56692,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./STM32_ using the LTDC display controller – hello world_files/wp-emoji-release.min.js" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="crayon-css" href="./STM32_ using the LTDC display controller – hello world_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-powershell-css" href="./STM32_ using the LTDC display controller – hello world_files/powershell.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="./STM32_ using the LTDC display controller – hello world_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="quotescollection-css" href="./STM32_ using the LTDC display controller – hello world_files/quotes-collection.css" type="text/css" media="all">
<link rel="stylesheet" id="hueman-main-style-css" href="./STM32_ using the LTDC display controller – hello world_files/main.min.css" type="text/css" media="all">
<link rel="stylesheet" id="theme-stylesheet-css" href="./STM32_ using the LTDC display controller – hello world_files/style.css" type="text/css" media="all">
<link rel="stylesheet" id="hueman-font-awesome-css" href="./STM32_ using the LTDC display controller – hello world_files/font-awesome.min.css" type="text/css" media="all">
<script type="text/javascript" src="./STM32_ using the LTDC display controller – hello world_files/jquery.js"></script>
<script type="text/javascript" src="./STM32_ using the LTDC display controller – hello world_files/jquery-migrate.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/www.lucadavidian.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="./STM32_ using the LTDC display controller – hello world_files/crayon.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var quotescollectionAjax = {"ajaxUrl":"http:\/\/www.lucadavidian.com\/wp-admin\/admin-ajax.php","nonce":"4cb5626019","loading":"Loading...","error":"Error getting quote","autoRefreshMax":"20","autoRefreshCount":"0"};
/* ]]> */
</script>
<script type="text/javascript" src="./STM32_ using the LTDC display controller – hello world_files/quotes-collection.js"></script>
<link rel="https://api.w.org/" href="http://www.lucadavidian.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.lucadavidian.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.lucadavidian.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Arduino M0 PRO: programming the core ARM Cortex-M0+ and the SAMD21 MCU" href="http://www.lucadavidian.com/2017/08/12/hello-world/">
<link rel="next" title="A simple game on STM32F429I Discovery board" href="http://www.lucadavidian.com/2017/10/02/a-simple-game-on-stm32f429i-discovery-board/">
<meta name="generator" content="WordPress 4.9.6">
<link rel="canonical" href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/">
<link rel="shortlink" href="http://www.lucadavidian.com/?p=359">
<link rel="alternate" type="application/json+oembed" href="http://www.lucadavidian.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.lucadavidian.com%2F2017%2F10%2F02%2Fstm32-using-the-ltdc-display-controller%2F">
<link rel="alternate" type="text/xml+oembed" href="http://www.lucadavidian.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.lucadavidian.com%2F2017%2F10%2F02%2Fstm32-using-the-ltdc-display-controller%2F&amp;format=xml">
<!--[if lt IE 9]>
<script src="http://www.lucadavidian.com/wp-content/themes/hueman/assets/front/js/ie/html5shiv-printshiv.min.js"></script>
<script src="http://www.lucadavidian.com/wp-content/themes/hueman/assets/front/js/ie/selectivizr.js"></script>
<![endif]-->
<link rel="icon" href="http://www.lucadavidian.com/wp-content/uploads/2017/08/cropped-mug-1-150x150.png" sizes="32x32">
<link rel="icon" href="http://www.lucadavidian.com/wp-content/uploads/2017/08/cropped-mug-1-300x300.png" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="http://www.lucadavidian.com/wp-content/uploads/2017/08/cropped-mug-1-300x300.png">
<meta name="msapplication-TileImage" content="http://www.lucadavidian.com/wp-content/uploads/2017/08/cropped-mug-1-300x300.png">
<style type="text/css" id="hu-dynamic-style">/* Dynamic CSS: For no styles in head, copy and put the css below in your child theme's style.css, disable dynamic styles */body { font-family:Tahoma, sans-serif;font-size:1.13rem }@media only screen and (min-width: 720px) {
        .nav > li { font-size:1.13rem; }
      }.sidebar .widget { padding-left: 20px; padding-right: 20px; padding-top: 20px; }#header { background-color: #0a0707; }
@media only screen and (min-width: 720px) {
  #nav-header .nav ul { background-color: #0a0707; }
}
        #header #nav-mobile { background-color: #0a0707; }.is-scrolled #header #nav-mobile { background-color: #0a0707; background-color: rgba(10,7,7,0.90) }#nav-header.nav-container, #main-header-search .search-expand { background-color: #000000; }
@media only screen and (min-width: 720px) {
  #nav-header .nav ul { background-color: #000000; }
}
        body { background-color: #000000; }</style>
</head>

<body class="post-template-default single single-post postid-359 single-format-standard wp-custom-logo col-2cl full-width header-mobile-sticky chrome hu-smoothscroll is-scrolled">

<div id="wrapper">

  
  <header id="header" class="main-menu-mobile-on one-mobile-menu main_menu header-ads-desktop  topbar-transparent">
        <nav class="nav-container group mobile-menu mobile-sticky " id="nav-mobile" data-menu-id="header-1">
  <div class="mobile-title-logo-in-header">                  <p class="site-title"><a class="custom-logo-link" href="http://www.lucadavidian.com/" rel="home" title="hello world | Home page">hello world</a></p>
                </div>
        
                    <!-- <div class="ham__navbar-toggler collapsed" aria-expanded="false">
          <div class="ham__navbar-span-wrapper">
            <span class="ham-toggler-menu__span"></span>
          </div>
        </div> -->
        <div class="ham__navbar-toggler-two collapsed" title="Menu" aria-expanded="false">
          <div class="ham__navbar-span-wrapper">
            <span class="line line-1"></span>
            <span class="line line-2"></span>
            <span class="line line-3"></span>
          </div>
        </div>
            
      <div class="nav-text"></div>
      <div class="nav-wrap container">
                <ul id="menu-menu" class="nav container-inner group"><li id="menu-item-28" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-28"><a href="http://www.lucadavidian.com/">Home</a></li>
</ul>      </div>
</nav><!--/#nav-topbar-->  
  
  <div class="container group">
        <div class="container-inner">

                <div id="header-image-wrap">
              <div class="group pad central-header-zone">
                                        <div class="logo-tagline-group">
                                            <p class="site-title"><a class="custom-logo-link" href="http://www.lucadavidian.com/" rel="home" title="hello world | Home page">hello world</a></p>
                                                                        <p class="site-description">a blog about coding</p>
                                                </div>
                                                  </div>

              <a href="http://www.lucadavidian.com/" rel="home"><img class="site-image" src="./STM32_ using the LTDC display controller – hello world_files/header.jpg" alt="hello world"></a>          </div>
      
                <nav class="nav-container group desktop-menu " id="nav-header" data-menu-id="header-2">
    <div class="nav-text"><!-- put your mobile menu text here --></div>

  <div class="nav-wrap container">
        <ul id="menu-menu-1" class="nav container-inner group"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-28"><a href="http://www.lucadavidian.com/">Home</a></li>
</ul>  </div>
</nav><!--/#nav-header-->      
    </div><!--/.container-inner-->
      </div><!--/.container-->

</header><!--/#header-->
  
  <div class="container" id="page">
    <div class="container-inner">
            <div class="main" style="overflow: hidden;">
        <div class="main-inner group">
          
              <section class="content">
              <div class="page-title pad group">
          	    		<ul class="meta-single group">
    			<li class="category"><a href="http://www.lucadavidian.com/category/arm/" rel="category tag">ARM</a> <span>/</span> <a href="http://www.lucadavidian.com/category/embedded/" rel="category tag">embedded</a> <span>/</span> <a href="http://www.lucadavidian.com/category/stm32/" rel="category tag">STM32</a></li>
    			    			<li class="comments"><a href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/#comments"><i class="fa fa-comments-o"></i>10</a></li>
    			    		</ul>

    	
    </div><!--/.page-title-->
          <div class="pad group">
              <article class="post-359 post type-post status-publish format-standard has-post-thumbnail hentry category-arm category-embedded category-stm32">
    <div class="post-inner group">

      <h1 class="post-title entry-title">STM32: using the LTDC display controller</h1>
<p class="post-byline">by   <span class="vcard author">
     <span class="fn"><a href="http://www.lucadavidian.com/author/wp_8383403/" title="Posts by Luca Davidian" rel="author">Luca Davidian</a></span>
   </span> ·
                            Published <time class="published" datetime="October 2, 2017">October 2, 2017</time>
              · Updated <time class="updated" datetime="February 14, 2018">February 14, 2018</time>
               </p>
      
      <div class="clear"></div>

      <div class="entry themeform">
        <div class="entry-inner">
		<img width="1024" height="548" src="./STM32_ using the LTDC display controller – hello world_files/image1-1024x548.jpg" class="attachment-large size-large wp-post-image" alt="" srcset="http://www.lucadavidian.com/wp-content/uploads/2017/10/image1-1024x548.jpg 1024w, http://www.lucadavidian.com/wp-content/uploads/2017/10/image1-300x160.jpg 300w, http://www.lucadavidian.com/wp-content/uploads/2017/10/image1-768x411.jpg 768w" sizes="(max-width: 1024px) 100vw, 1024px">          <p>The STM32 LTDC has a peripheral called <strong>LTDC LCD TFT Display Controller </strong>which<strong>&nbsp;</strong>provides a <strong>digital parallel interface </strong>(<strong>DPI</strong>)&nbsp;for a variety of LCD and TFT panels. It sends RGB data in parallel to the display and generates signals for <em>horizontal and vertical synchronization</em> (<strong>HSYNC</strong>, <strong>VSYNC</strong>), as well as <em>pixel clock</em> (<strong>PCLK</strong>) and <em>not data enable</em> (<strong>DE</strong>) signals:</p>
<div id="attachment_374" style="width: 953px" class="wp-caption aligncenter"><img class="wp-image-374 " src="./STM32_ using the LTDC display controller – hello world_files/LTDCsignals.jpg" alt="" width="943" height="380" srcset="http://www.lucadavidian.com/wp-content/uploads/2017/10/LTDCsignals.jpg 996w, http://www.lucadavidian.com/wp-content/uploads/2017/10/LTDCsignals-300x121.jpg 300w, http://www.lucadavidian.com/wp-content/uploads/2017/10/LTDCsignals-768x310.jpg 768w" sizes="(max-width: 943px) 100vw, 943px"><p class="wp-caption-text">figure 1: LTDC RGB interface signals</p></div>
<h3>RGB interface synchronization signals</h3>
<p>LTDC synchronous timing parameters are configurable: a <strong>synchronous timing generator block</strong> inside the LTDC generates the horizontal and vertical synchronization signals, the pixel clock and not data enable signals. The configurable timing parameters are:</p>
<ul>
<li><strong>LTDC_SSCR </strong><em>Synchronization Size Configuration</em> <em>Register</em>, configured by programming the values&nbsp;<em>HSYNC width – 1</em>&nbsp; and <em>VSYNC width – 1</em></li>
<li><strong>LTDC_BPCR</strong> <em>Back Porch Configuration Register</em>, configured by programming the&nbsp;accumulated values <em>HSYNC width + horizontal back porch – 1</em> and <em>VSYNC width + vertical back porch – 1</em></li>
<li><strong>LTDC_AWCR</strong> <em>Active Width Configuration Register</em>, configured by programming the accumulated values&nbsp;&nbsp;<em>HSYNC width + horizontal back porch + active width – 1</em> and&nbsp;<em>VSYNC width + vertical back porch + active height –&nbsp;1</em></li>
<li><strong>LTDC_TWCR</strong> <em>Total Width Configuration Register</em>, configured by programming the accumulated values&nbsp; <em>HSYNC width + horizontal back porch + active width + horizontal front porch – 1</em> and&nbsp;<em>VSYNC width + vertical back porch + active height + vertical front porch – 1&nbsp;</em></li>
</ul>
<div id="attachment_385" style="width: 934px" class="wp-caption aligncenter"><img class="wp-image-385 " src="./STM32_ using the LTDC display controller – hello world_files/timings-1.jpg" alt="" width="924" height="1186" srcset="http://www.lucadavidian.com/wp-content/uploads/2017/10/timings-1.jpg 987w, http://www.lucadavidian.com/wp-content/uploads/2017/10/timings-1-234x300.jpg 234w, http://www.lucadavidian.com/wp-content/uploads/2017/10/timings-1-768x986.jpg 768w, http://www.lucadavidian.com/wp-content/uploads/2017/10/timings-1-798x1024.jpg 798w" sizes="(max-width: 924px) 100vw, 924px"><p class="wp-caption-text">figure 2: RGB interface timing and horizontal/vertical synchronization, pixel clock and data enable signals</p></div>
<p>Horizontal timing signal widths are in <strong>units of pixel clocks</strong>, while vertical timing signal widths are in <strong>units of</strong> <strong>horizontal scan lines</strong>. The HSYNC, VSYNC, pixel clock and not data enable signal polarities can be configured to active high or active low in the <strong>LTDC_GCR</strong> <em>Global Control Register&nbsp;</em>(<em>not data enable</em> signal must be configured <strong>inverted </strong>with respect to the <em>data enable</em> signal in the display datasheet). The datasheet of the panel generally provides the timing parameters for the display:</p>
<div id="attachment_400" style="width: 972px" class="wp-caption aligncenter"><img class="wp-image-400 " src="./STM32_ using the LTDC display controller – hello world_files/timingsILI9341.jpg" alt="" width="962" height="352" srcset="http://www.lucadavidian.com/wp-content/uploads/2017/10/timingsILI9341.jpg 1131w, http://www.lucadavidian.com/wp-content/uploads/2017/10/timingsILI9341-300x110.jpg 300w, http://www.lucadavidian.com/wp-content/uploads/2017/10/timingsILI9341-768x281.jpg 768w, http://www.lucadavidian.com/wp-content/uploads/2017/10/timingsILI9341-1024x375.jpg 1024w" sizes="(max-width: 962px) 100vw, 962px"><p class="wp-caption-text">figure 3: RGB panel timing signals</p></div>
<p>Configuring the timing signals is the first thing to do to initialize the LTDC controller. The function <em>HAL_LTDC_MspInit()&nbsp;</em>initializes the low level details of the LTDC peripheral (clock and GPIOs):</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5b10ec5f6f555738285103" class="crayon-syntax crayon-theme-powershell crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">/* initialize LTDC */
HAL_LTDC_MspInit(&amp;ltdc);  // initialize LTDC clock and pins

LTDC-&gt;GCR &amp;= ~(LTDC_GCR_HSPOL | LTDC_GCR_VSPOL | LTDC_GCR_DEPOL | LTDC_GCR_PCPOL);    // synchronization signal polarities
LTDC-&gt;SSCR = 9 &lt;&lt; LTDC_SSCR_HSW_Pos | 1 &lt;&lt; LTDC_SSCR_VSH_Pos;                         // HSYNC and VSYNC length
LTDC-&gt;BPCR = 29 &lt;&lt; LTDC_BPCR_AHBP_Pos | 3 &lt;&lt; LTDC_BPCR_AVBP_Pos;                      // horizontal and vertical accumulated back porch
LTDC-&gt;AWCR = 269 &lt;&lt; LTDC_AWCR_AAW_Pos | 323 &lt;&lt; LTDC_AWCR_AAH_Pos;                     // accumulated active width and height
LTDC-&gt;TWCR = 279 &lt;&lt; LTDC_TWCR_TOTALW_Pos | 327 &lt;&lt; LTDC_TWCR_TOTALH_Pos;               // accumulated total width and height</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5b10ec5f6f555738285103-1">1</div><div class="crayon-num" data-line="crayon-5b10ec5f6f555738285103-2">2</div><div class="crayon-num" data-line="crayon-5b10ec5f6f555738285103-3">3</div><div class="crayon-num" data-line="crayon-5b10ec5f6f555738285103-4">4</div><div class="crayon-num" data-line="crayon-5b10ec5f6f555738285103-5">5</div><div class="crayon-num" data-line="crayon-5b10ec5f6f555738285103-6">6</div><div class="crayon-num" data-line="crayon-5b10ec5f6f555738285103-7">7</div><div class="crayon-num" data-line="crayon-5b10ec5f6f555738285103-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5b10ec5f6f555738285103-1"><span class="crayon-c">/* initialize LTDC */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f555738285103-2"><span class="crayon-e">HAL_LTDC_MspInit</span><span class="crayon-sy">(</span><span class="crayon-o">&amp;</span><span class="crayon-v">ltdc</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// initialize LTDC clock and pins</span></div><div class="crayon-line" id="crayon-5b10ec5f6f555738285103-3">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f555738285103-4"><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">GCR</span><span class="crayon-h"> </span><span class="crayon-o">&amp;=</span><span class="crayon-h"> </span><span class="crayon-o">~</span><span class="crayon-sy">(</span><span class="crayon-v">LTDC_GCR_HSPOL</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_GCR_VSPOL</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_GCR_DEPOL</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_GCR_PCPOL</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// synchronization signal polarities</span></div><div class="crayon-line" id="crayon-5b10ec5f6f555738285103-5"><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">SSCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_SSCR_HSW_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_SSCR_VSH_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// HSYNC and VSYNC length</span></div><div class="crayon-line" id="crayon-5b10ec5f6f555738285103-6"><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">BPCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">29</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_BPCR_AHBP_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_BPCR_AVBP_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// horizontal and vertical accumulated back porch</span></div><div class="crayon-line" id="crayon-5b10ec5f6f555738285103-7"><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">AWCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">269</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_AWCR_AAW_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">323</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_AWCR_AAH_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// accumulated active width and height</span></div><div class="crayon-line" id="crayon-5b10ec5f6f555738285103-8"><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">TWCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">279</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_TWCR_TOTALW_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">327</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_TWCR_TOTALH_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// accumulated total width and height</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0024 seconds] -->
<p>A constant background color can be configured in <strong>LTDC_BCCR</strong> <em>Background Color Configuration Register&nbsp;</em>(eight bits per channel are used in this register to select a solid RGB color):</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5b10ec5f6f564856597488" class="crayon-syntax crayon-theme-powershell crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">LTDC-&gt;BCCR = 0x00 &lt;&lt; LTDC_BCCR_BCRED_Pos | 0xFF &lt;&lt; LTDC_BCCR_BCGREEN_Pos | 0x00 &lt;&lt; LTDC_BCCR_BCBLUE_Pos;  // background color (green)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row alt">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5b10ec5f6f564856597488-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5b10ec5f6f564856597488-1"><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">BCCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0x00</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_BCCR_BCRED_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_BCCR_BCGREEN_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">0x00</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_BCCR_BCBLUE_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// background color (green)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>The background color is used for blending with the bottom layer.</p>
<h3>Layer configuration</h3>
<p>The LTDC has two layers which can be configured, enabled and disabled independently, each with its own FIFO buffer. Layer order is fixed and layer2 is alway on top of layer1. Layer can be enabled writing the <em>LEN Layer Enable bit</em> in the <strong>LTDC_LxCR</strong> <em>Layer x Control Register</em>. Each layer gets its data from a <strong>framebuffer in memory</strong> and the start address is written in <strong>LTDC_LxCFBAR&nbsp;</strong> <em>Layer x Color Frame Buffer Address Register</em>. The frame buffer contains the display frame data in <strong>one of eight configurable pixel format</strong>: <strong>LTDC_LxPFCR</strong> <em>Layer x Pixel Format Configuration Register&nbsp;</em>is configured to choose the pixel format used to store data into the frame buffer. The available pixel formats are:</p>
<ul>
<li>ARGB8888</li>
<li>RGB888</li>
<li>RGB565</li>
<li>ARGB1555</li>
<li>ARGB4444</li>
<li>L8 (8 bit luminance)</li>
<li>AL44 (4 bit alpha, 4 bit luminance)</li>
<li>AL88 (8 bit alpha, 8 bit luminance)</li>
</ul>
<p>The pixel data are read from the frame buffer and converted to the LTDC internal 32-bit pixel format ARGB8888:</p>
<div id="attachment_399" style="width: 953px" class="wp-caption aligncenter"><img class="wp-image-399" src="./STM32_ using the LTDC display controller – hello world_files/bpp.jpg" alt="" width="943" height="326" srcset="http://www.lucadavidian.com/wp-content/uploads/2017/10/bpp.jpg 1380w, http://www.lucadavidian.com/wp-content/uploads/2017/10/bpp-300x103.jpg 300w, http://www.lucadavidian.com/wp-content/uploads/2017/10/bpp-768x265.jpg 768w, http://www.lucadavidian.com/wp-content/uploads/2017/10/bpp-1024x353.jpg 1024w" sizes="(max-width: 943px) 100vw, 943px"><p class="wp-caption-text">figure 4: whatever the framebuffer pixel format the LTDC converts the data into the internal 32 bit ARGB8888 pixel format</p></div>
<p>Each layer can be positioned and resized inside the active area indicating the start and stop position of the visible window in the <strong>LTDC_LxWHPCR</strong> <em>Layer x Window Horizontal Position Configuration Register</em> and <strong>LTDC_LxWVPCR</strong> <em>Layer x Window Vertical Position Configuration Register</em>. These parameters select the first and last visible pixels of a line and the first and last visible lines in the window. The values must includes the timing signals (HSYNC and VSYNC) width and the back porch width programmed into <strong>LTDC_BPCR </strong>register. In this case the accumulated horizontal back porch is 30 – 1, so the active area starts at 30 and the image is 240 pixel wide so horizontal window stop position is 30 + 240 – 1 = 269 (same for the vertical start and stop positions):</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5b10ec5f6f56d059460022" class="crayon-syntax crayon-theme-powershell crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">/* configure layer 1 */
LTDC_Layer1-&gt;WHPCR = 269 &lt;&lt; LTDC_LxWHPCR_WHSPPOS_Pos | 30 &lt;&lt; LTDC_LxWHPCR_WHSTPOS_Pos;          // window horizontal start/stop positions
LTDC_Layer1-&gt;WVPCR = 323 &lt;&lt; LTDC_LxWVPCR_WVSPPOS_Pos | 4 &lt;&lt; LTDC_LxWVPCR_WVSTPOS_Pos;           // window vertical start/stop positions
LTDC_Layer1-&gt;PFCR = 0x01;                                                                       // RGB888 pixel format
LTDC_Layer1-&gt;CFBAR = (uint32_t)framebuffer;                                                     // frame buffer start address</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5b10ec5f6f56d059460022-1">1</div><div class="crayon-num" data-line="crayon-5b10ec5f6f56d059460022-2">2</div><div class="crayon-num" data-line="crayon-5b10ec5f6f56d059460022-3">3</div><div class="crayon-num" data-line="crayon-5b10ec5f6f56d059460022-4">4</div><div class="crayon-num" data-line="crayon-5b10ec5f6f56d059460022-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5b10ec5f6f56d059460022-1"><span class="crayon-c">/* configure layer 1 */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f56d059460022-2"><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">WHPCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">269</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWHPCR_WHSPPOS_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWHPCR_WHSTPOS_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// window horizontal start/stop positions</span></div><div class="crayon-line" id="crayon-5b10ec5f6f56d059460022-3"><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">WVPCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">323</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWVPCR_WVSPPOS_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWVPCR_WVSTPOS_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// window vertical start/stop positions</span></div><div class="crayon-line" id="crayon-5b10ec5f6f56d059460022-4"><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">PFCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0x01</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// RGB888 pixel format</span></div><div class="crayon-line" id="crayon-5b10ec5f6f56d059460022-5"><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CFBAR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">uint32_t</span><span class="crayon-sy">)</span><span class="crayon-v">framebuffer</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// frame buffer start address</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>The frame buffer has a configurable <strong>line length</strong>&nbsp;(in bytes) in the <strong>LTDC_LxCFBLR</strong> <em>Layer x Color Frame Buffer Length Register</em>&nbsp;&nbsp;and&nbsp;a configurable <strong>total number of lines</strong> in the <strong>LTDC_LxCFBLNR</strong> <em>Layer x Color Frame Buffer Line Number Register</em>. It also has a configurable <strong>line pitch</strong>, which indicates the distance in bytes between the start of a line and the beginning of the next line, also configured in the <strong>LTDC_LxCFBLR </strong>register, and expressed in bytes. These parameters are used by the LTDC to fetch data from the frame buffer to the layer FIFO. If set to less byte than needed, a FIFO underrun interrupt will trigger (if enabled), if set to more bytes than required the rest of the data loaded into the layer’s FIFO is discarded.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5b10ec5f6f574475994517" class="crayon-syntax crayon-theme-powershell crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">LTDC_Layer1-&gt;CFBLR = 240 * 3 &lt;&lt; LTDC_LxCFBLR_CFBP_Pos | 240 * 3 + 3 &lt;&lt; LTDC_LxCFBLR_CFBLL_Pos;  // frame buffer line length and pitch
LTDC_Layer1-&gt;CFBLNR = 320;                                                                      // frame buffer line number</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row alt">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5b10ec5f6f574475994517-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f574475994517-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5b10ec5f6f574475994517-1"><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CFBLR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">240</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxCFBLR_CFBP_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">240</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxCFBLR_CFBLL_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// frame buffer line length and pitch</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f574475994517-2"><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CFBLNR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">320</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// frame buffer line number</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>Line length parameter is the number of bytes in a line plus three (so the total line length is <em>number of pixels * bits per pixel + 3</em>). These parameters, together with the layer windowing settings, are useful if we want to display part of an image contained in the frame buffer, as I’ll show later.</p>
<p>Each layer can also have a default color, configured into the <strong>LTDC_LxDCCR</strong> <em>Layer x Default Color Configuration Register,</em>&nbsp;in ARGB8888 format, that is used outside the layer window or when a layer is disabled:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5b10ec5f6f57a648228620" class="crayon-syntax crayon-theme-powershell crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">LTDC_Layer1-&gt;DCCR = 0xFF &lt;&lt; LTDC_LxDCCR_DCALPHA_Pos | 0xFF &lt;&lt; LTDC_LxDCCR_DCGREEN_Pos;          // layer default color (solid green)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5b10ec5f6f57a648228620-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5b10ec5f6f57a648228620-1"><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">DCCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxDCCR_DCALPHA_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxDCCR_DCGREEN_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// layer default color (solid green)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>A constant alpha blending value is configured into the&nbsp;<strong>LTDC_LxCACR&nbsp;</strong><em>Layer x Constant Alpha Configuration Register</em>, and controls the alpha blending with the underlying layers. In this case the value 255 (which is divided by 255 by hardware to get a value between 0 and 1) indicates a solid color:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5b10ec5f6f57f589512212" class="crayon-syntax crayon-theme-powershell crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">LTDC_Layer1-&gt;CACR = 255;                                                                        // constant alpha</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row alt">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5b10ec5f6f57f589512212-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5b10ec5f6f57f589512212-1"><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CACR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// constant alpha</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Blending order is fixed and if both layers are enabled, first layer 1 is blended with the background and then layer 2 is blended with the result:</p>
<div id="attachment_523" style="width: 868px" class="wp-caption aligncenter"><img class="wp-image-523 " src="./STM32_ using the LTDC display controller – hello world_files/blend.jpg" alt="" width="858" height="323" srcset="http://www.lucadavidian.com/wp-content/uploads/2017/10/blend.jpg 959w, http://www.lucadavidian.com/wp-content/uploads/2017/10/blend-300x113.jpg 300w, http://www.lucadavidian.com/wp-content/uploads/2017/10/blend-768x289.jpg 768w" sizes="(max-width: 858px) 100vw, 858px"><p class="wp-caption-text">figure 5: layer blending</p></div>
<p>Then the layer is enabled by writing the LEN bit into the LTDC_LxCR LTDC Layer x Control Register:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5b10ec5f6f585842222021" class="crayon-syntax crayon-theme-powershell crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">LTDC_Layer1-&gt;CR |= LTDC_LxCR_LEN;                                                               // enable layer1</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5b10ec5f6f585842222021-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5b10ec5f6f585842222021-1"><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CR</span><span class="crayon-h"> </span><span class="crayon-o">|=</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxCR_LEN</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// enable layer1</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<h3>Shadow configuration registers</h3>
<p>Some configuration registers are&nbsp;<em>shadowed</em>, meaning their programmed values are stored into&nbsp;<em>shadow registers</em>&nbsp;(not accessible to the programmer) and reloaded into the actual configuration registers based on the configuration of the <strong>LTDC_SRCR</strong> <em>Shadow Reload Configuration Register</em>: if this register is written with the IMR&nbsp;<strong>Immediate Reload</strong> bit the registers are reloaded immediately (as soon as the IMR bit is set the registers are reloaded), if the <strong>Vertical Blanking Reload</strong> bit is written the registers are reloaded with the new values during the vertical blanking period (at the beginning of the first line after the active display area). These bits are set in software and cleared by hardware when shadow registers are reloaded:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5b10ec5f6f58b189141982" class="crayon-syntax crayon-theme-powershell crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">/* reload shadow registers and enable LTDC */
LTDC-&gt;SRCR = LTDC_SRCR_IMR;     // immediate shadow registers reload (before enabling LTDC)
LTDC-&gt;GCR |= LTDC_GCR_LTDCEN;   // enable LTDC</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row alt">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5b10ec5f6f58b189141982-1">1</div><div class="crayon-num" data-line="crayon-5b10ec5f6f58b189141982-2">2</div><div class="crayon-num" data-line="crayon-5b10ec5f6f58b189141982-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5b10ec5f6f58b189141982-1"><span class="crayon-c">/* reload shadow registers and enable LTDC */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f58b189141982-2"><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">SRCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_SRCR_IMR</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// immediate shadow registers reload (before enabling LTDC)</span></div><div class="crayon-line" id="crayon-5b10ec5f6f58b189141982-3"><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">GCR</span><span class="crayon-h"> </span><span class="crayon-o">|=</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_GCR_LTDCEN</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// enable LTDC</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>The registers read the old values until they’re reloaded and if a new value is written before they’re reloaded the previous value is overwritten. Most of the layers’ configuration registers are shadowed so they must be reloaded after being configured and before anabling the LTDC. The complete LTDC_init() function looks like this:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5b10ec5f6f590777384759" class="crayon-syntax crayon-theme-powershell crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">void LTDC_init(void)
{
  /* initialize LTDC */
  HAL_LTDC_MspInit(&amp;ltdc);                                                                       // initialize LTDC low level hardware (clock and pins)

  /* configure LTDC general parameters */
  LTDC-&gt;GCR &amp;= ~(LTDC_GCR_HSPOL | LTDC_GCR_VSPOL | LTDC_GCR_DEPOL | LTDC_GCR_PCPOL);             // signal polarities
  LTDC-&gt;SSCR = 9 &lt;&lt; LTDC_SSCR_HSW_Pos | 1 &lt;&lt; LTDC_SSCR_VSH_Pos;                                  // HSYNC and VSYNC length
  LTDC-&gt;BPCR = 29 &lt;&lt; LTDC_BPCR_AHBP_Pos | 3 &lt;&lt; LTDC_BPCR_AVBP_Pos;                               // horizontal and vertical accumulated back porch 
  LTDC-&gt;AWCR = 269 &lt;&lt; LTDC_AWCR_AAW_Pos | 323 &lt;&lt; LTDC_AWCR_AAH_Pos;                              // accumulated active width and height
  LTDC-&gt;TWCR = 279 &lt;&lt; LTDC_TWCR_TOTALW_Pos | 327 &lt;&lt; LTDC_TWCR_TOTALH_Pos;                        // accumulated total width and height
  LTDC-&gt;BCCR = 0xFF &lt;&lt; LTDC_BCCR_BCGREEN_Pos;                                                    // green background color

  /* configure layer 1 */
  LTDC_Layer1-&gt;WHPCR = 269 &lt;&lt; LTDC_LxWHPCR_WHSPPOS_Pos | 30 &lt;&lt; LTDC_LxWHPCR_WHSTPOS_Pos;          // window horizontal start/stop positions
  LTDC_Layer1-&gt;WVPCR = 323 &lt;&lt; LTDC_LxWVPCR_WVSPPOS_Pos | 4 &lt;&lt; LTDC_LxWVPCR_WVSTPOS_Pos;           // window vertical start/stop positions
  LTDC_Layer1-&gt;PFCR = 0x01;   // RGB888 pixel format
  LTDC_Layer1-&gt;DCCR = 0xFF &lt;&lt; LTDC_LxDCCR_DCALPHA_Pos | 0xFF &lt;&lt; LTDC_LxDCCR_DCGREEN_Pos;          // layer default color
  LTDC_Layer1-&gt;CFBAR = (uint32_t)image;                                                           // frame buffer start address
  LTDC_Layer1-&gt;CFBLR = 240 * 3 &lt;&lt; LTDC_LxCFBLR_CFBP_Pos | 240 * 3 + 3 &lt;&lt; LTDC_LxCFBLR_CFBLL_Pos;  // frame buffer line length and pitch
  LTDC_Layer1-&gt;CFBLNR = 320;                                                                      // frame buffer line number
  LTDC_Layer1-&gt;CACR = 255;                                                                        // constant alpha
  LTDC_Layer1-&gt;CR |= LTDC_LxCR_LEN;                                                               // enable layer1

  LTDC-&gt;SRCR = LTDC_SRCR_IMR;                                                                     // immediate shadow registers reload 

  LTDC-&gt;GCR |= LTDC_GCR_LTDCEN;                                                                   // enable LTDC
}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-1">1</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-2">2</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-3">3</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-4">4</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-5">5</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-6">6</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-7">7</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-8">8</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-9">9</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-10">10</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-11">11</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-12">12</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-13">13</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-14">14</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-15">15</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-16">16</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-17">17</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-18">18</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-19">19</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-20">20</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-21">21</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-22">22</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-23">23</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-24">24</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-25">25</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-26">26</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-27">27</div><div class="crayon-num" data-line="crayon-5b10ec5f6f590777384759-28">28</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-1"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">LTDC_init</span><span class="crayon-sy">(</span><span class="crayon-t">void</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* initialize LTDC */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">HAL_LTDC_MspInit</span><span class="crayon-sy">(</span><span class="crayon-o">&amp;</span><span class="crayon-v">ltdc</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// initialize LTDC low level hardware (clock and pins)</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-5">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* configure LTDC general parameters */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">GCR</span><span class="crayon-h"> </span><span class="crayon-o">&amp;=</span><span class="crayon-h"> </span><span class="crayon-o">~</span><span class="crayon-sy">(</span><span class="crayon-v">LTDC_GCR_HSPOL</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_GCR_VSPOL</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_GCR_DEPOL</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_GCR_PCPOL</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// signal polarities</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">SSCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_SSCR_HSW_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_SSCR_VSH_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// HSYNC and VSYNC length</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">BPCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">29</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_BPCR_AHBP_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_BPCR_AVBP_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// horizontal and vertical accumulated back porch </span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">AWCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">269</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_AWCR_AAW_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">323</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_AWCR_AAH_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// accumulated active width and height</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">TWCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">279</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_TWCR_TOTALW_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">327</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_TWCR_TOTALH_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// accumulated total width and height</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">BCCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_BCCR_BCGREEN_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// green background color</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-13">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* configure layer 1 */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">WHPCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">269</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWHPCR_WHSPPOS_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWHPCR_WHSTPOS_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// window horizontal start/stop positions</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">WVPCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">323</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWVPCR_WVSPPOS_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWVPCR_WVSTPOS_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// window vertical start/stop positions</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">PFCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0x01</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// RGB888 pixel format</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">DCCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxDCCR_DCALPHA_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxDCCR_DCGREEN_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// layer default color</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CFBAR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">uint32_t</span><span class="crayon-sy">)</span><span class="crayon-v">image</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// frame buffer start address</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CFBLR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">240</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxCFBLR_CFBP_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">240</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxCFBLR_CFBLL_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// frame buffer line length and pitch</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-21"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CFBLNR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">320</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// frame buffer line number</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-22"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CACR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// constant alpha</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-23"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CR</span><span class="crayon-h"> </span><span class="crayon-o">|=</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxCR_LEN</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// enable layer1</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-24">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-25"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">SRCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_SRCR_IMR</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// immediate shadow registers reload </span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-26">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-27"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">GCR</span><span class="crayon-h"> </span><span class="crayon-o">|=</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_GCR_LTDCEN</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// enable LTDC</span></div><div class="crayon-line" id="crayon-5b10ec5f6f590777384759-28"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0057 seconds] -->
<p></p>
<h3>using the LTDC with the ILI9341 display controller</h3>
<p>In this example I use the display on the STM32F429-Discovery board, which is driven by the ILI9341 display controller. The ILI9341 can drive a QVGA (Quarter VGA) 240×320 262,144 colors LCD display. The controller can be configured via SPI (or parallel interface, depending on the panel settings) to use a digital parallel 18 bit RGB interface (since only 6 lines per color channel are wired on the board to the LTDC).&nbsp;Since the display pixel format is less than 8 bit per channel (RGB666 in this case), the RGB display data lines are connected to the most significant bits of the LTDC controller RGB data lines:</p>
<div id="attachment_398" style="width: 972px" class="wp-caption aligncenter"><img class="wp-image-398" src="./STM32_ using the LTDC display controller – hello world_files/rgb__.jpg" alt="" width="962" height="632" srcset="http://www.lucadavidian.com/wp-content/uploads/2017/10/rgb__.jpg 1462w, http://www.lucadavidian.com/wp-content/uploads/2017/10/rgb__-300x197.jpg 300w, http://www.lucadavidian.com/wp-content/uploads/2017/10/rgb__-768x504.jpg 768w, http://www.lucadavidian.com/wp-content/uploads/2017/10/rgb__-1024x672.jpg 1024w" sizes="(max-width: 962px) 100vw, 962px"><p class="wp-caption-text">figure 5: LTDC signal lines. Only MSB are used if the display has less than 8 lines per color channel</p></div>
<p>Before enabling the LTDC we must configure the clock system. The LTDC uses a specific clock LCD_CLOCK to generate the pixel clock signal and it must be configured and enabled during the system initialization phase:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5b10ec5f6f598431104320" class="crayon-syntax crayon-theme-powershell crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">void system_clock_config(void)
{
  RCC_OscInitTypeDef RCC_OscInitStruct;
  RCC_ClkInitTypeDef RCC_ClkInitStruct;
  RCC_PeriphCLKInitTypeDef PeriphClkInitStruct;

  /* Configure the main internal regulator output voltage */
  __HAL_RCC_PWR_CLK_ENABLE();

  __HAL_PWR_VOLTAGESCALING_CONFIG(PWR_REGULATOR_VOLTAGE_SCALE1);

  /* Initialize the CPU, AHB and APB busses clocks */
  RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_HSI;
  RCC_OscInitStruct.HSIState = RCC_HSI_ON;
  RCC_OscInitStruct.HSICalibrationValue = 16;
  RCC_OscInitStruct.PLL.PLLState = RCC_PLL_ON;
  RCC_OscInitStruct.PLL.PLLSource = RCC_PLLSOURCE_HSI;
  RCC_OscInitStruct.PLL.PLLM = 8;
  RCC_OscInitStruct.PLL.PLLN = 180;
  RCC_OscInitStruct.PLL.PLLP = RCC_PLLP_DIV2;
  RCC_OscInitStruct.PLL.PLLQ = 7;
  HAL_RCC_OscConfig(&amp;RCC_OscInitStruct);

  /* Activate the Over-Drive mode */
  HAL_PWREx_EnableOverDrive();

  /* Initialize the CPU, AHB and APB busses clocks */
  RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_HCLK|RCC_CLOCKTYPE_SYSCLK|RCC_CLOCKTYPE_PCLK1|RCC_CLOCKTYPE_PCLK2;
  RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;
  RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;
  RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV4;
  RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV2;

  HAL_RCC_ClockConfig(&amp;RCC_ClkInitStruct, FLASH_LATENCY_5);

  /* initialize LTDC LCD clock */
  PeriphClkInitStruct.PeriphClockSelection = RCC_PERIPHCLK_LTDC;
  PeriphClkInitStruct.PLLSAI.PLLSAIN = 60;
  PeriphClkInitStruct.PLLSAI.PLLSAIR = 5;
  PeriphClkInitStruct.PLLSAIDivR = RCC_PLLSAIDIVR_4;
  HAL_RCCEx_PeriphCLKConfig(&amp;PeriphClkInitStruct);
}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row alt">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-1">1</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-2">2</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-3">3</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-4">4</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-5">5</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-6">6</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-7">7</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-8">8</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-9">9</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-10">10</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-11">11</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-12">12</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-13">13</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-14">14</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-15">15</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-16">16</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-17">17</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-18">18</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-19">19</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-20">20</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-21">21</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-22">22</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-23">23</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-24">24</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-25">25</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-26">26</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-27">27</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-28">28</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-29">29</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-30">30</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-31">31</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-32">32</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-33">33</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-34">34</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-35">35</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-36">36</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-37">37</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-38">38</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-39">39</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-40">40</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-41">41</div><div class="crayon-num" data-line="crayon-5b10ec5f6f598431104320-42">42</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-1"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">system_clock_config</span><span class="crayon-sy">(</span><span class="crayon-t">void</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">RCC_OscInitTypeDef </span><span class="crayon-v">RCC_OscInitStruct</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">RCC_ClkInitTypeDef </span><span class="crayon-v">RCC_ClkInitStruct</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">RCC_PeriphCLKInitTypeDef </span><span class="crayon-v">PeriphClkInitStruct</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-6">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* Configure the main internal regulator output voltage */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">__HAL_RCC_PWR_CLK_ENABLE</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-9">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">__HAL_PWR_VOLTAGESCALING_CONFIG</span><span class="crayon-sy">(</span><span class="crayon-v">PWR_REGULATOR_VOLTAGE_SCALE1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-11">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* Initialize the CPU, AHB and APB busses clocks */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">RCC_OscInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">OscillatorType</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">RCC_OSCILLATORTYPE_HSI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">RCC_OscInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">HSIState</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">RCC_HSI_ON</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">RCC_OscInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">HSICalibrationValue</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">RCC_OscInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">PLL</span><span class="crayon-sy">.</span><span class="crayon-v">PLLState</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">RCC_PLL_ON</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">RCC_OscInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">PLL</span><span class="crayon-sy">.</span><span class="crayon-v">PLLSource</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">RCC_PLLSOURCE_HSI</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">RCC_OscInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">PLL</span><span class="crayon-sy">.</span><span class="crayon-v">PLLM</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">RCC_OscInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">PLL</span><span class="crayon-sy">.</span><span class="crayon-v">PLLN</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">180</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">RCC_OscInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">PLL</span><span class="crayon-sy">.</span><span class="crayon-v">PLLP</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">RCC_PLLP_DIV2</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-21"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">RCC_OscInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">PLL</span><span class="crayon-sy">.</span><span class="crayon-v">PLLQ</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-22"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">HAL_RCC_OscConfig</span><span class="crayon-sy">(</span><span class="crayon-o">&amp;</span><span class="crayon-v">RCC_OscInitStruct</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-23">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-24"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* Activate the Over-Drive mode */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-25"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">HAL_PWREx_EnableOverDrive</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-26">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-27"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* Initialize the CPU, AHB and APB busses clocks */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-28"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">RCC_ClkInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">ClockType</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">RCC_CLOCKTYPE_HCLK</span><span class="crayon-o">|</span><span class="crayon-v">RCC_CLOCKTYPE_SYSCLK</span><span class="crayon-o">|</span><span class="crayon-v">RCC_CLOCKTYPE_PCLK1</span><span class="crayon-o">|</span><span class="crayon-v">RCC_CLOCKTYPE_PCLK2</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-29"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">RCC_ClkInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">SYSCLKSource</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">RCC_SYSCLKSOURCE_PLLCLK</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-30"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">RCC_ClkInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">AHBCLKDivider</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">RCC_SYSCLK_DIV1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-31"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">RCC_ClkInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">APB1CLKDivider</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">RCC_HCLK_DIV4</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-32"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">RCC_ClkInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">APB2CLKDivider</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">RCC_HCLK_DIV2</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-33">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-34"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">HAL_RCC_ClockConfig</span><span class="crayon-sy">(</span><span class="crayon-o">&amp;</span><span class="crayon-v">RCC_ClkInitStruct</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">FLASH_LATENCY_5</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-35">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-36"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* initialize LTDC LCD clock */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-37"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">PeriphClkInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">PeriphClockSelection</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">RCC_PERIPHCLK_LTDC</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-38"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">PeriphClkInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">PLLSAI</span><span class="crayon-sy">.</span><span class="crayon-v">PLLSAIN</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-39"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">PeriphClkInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">PLLSAI</span><span class="crayon-sy">.</span><span class="crayon-v">PLLSAIR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-40"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">PeriphClkInitStruct</span><span class="crayon-sy">.</span><span class="crayon-v">PLLSAIDivR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">RCC_PLLSAIDIVR_4</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-41"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">HAL_RCCEx_PeriphCLKConfig</span><span class="crayon-sy">(</span><span class="crayon-o">&amp;</span><span class="crayon-v">PeriphClkInitStruct</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f598431104320-42"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0045 seconds] -->
<p>The HAL_LTDC_MspInit() function, called at the beginning of LTDC_init() enables the LTDC peripheral clock and takes care of the low level hardware initialization:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5b10ec5f6f59f432597479" class="crayon-syntax crayon-theme-powershell crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">void HAL_LTDC_MspInit(LTDC_HandleTypeDef *ltdc)
{
  GPIO_InitTypeDef GPIO_InitStructure;

  /* Enable the LTDC clock */
  __HAL_RCC_LTDC_CLK_ENABLE();

  /* Enable GPIOs clock */
  __HAL_RCC_GPIOA_CLK_ENABLE();
  __HAL_RCC_GPIOB_CLK_ENABLE();
  __HAL_RCC_GPIOC_CLK_ENABLE();
  __HAL_RCC_GPIOD_CLK_ENABLE();
  __HAL_RCC_GPIOF_CLK_ENABLE();
  __HAL_RCC_GPIOG_CLK_ENABLE();

	/* GPIOs Configuration */
	/*
	   +------------------------+-----------------------+----------------------------+
	   +                       LCD pins assignment                                   +
	   +------------------------+-----------------------+----------------------------+
	   |  LCD_TFT R2 &lt;-&gt; PC.10  |  LCD_TFT G2 &lt;-&gt; PA.06 |  LCD_TFT B2 &lt;-&gt; PD.06      |
	   |  LCD_TFT R3 &lt;-&gt; PB.00  |  LCD_TFT G3 &lt;-&gt; PG.10 |  LCD_TFT B3 &lt;-&gt; PG.11      |
	   |  LCD_TFT R4 &lt;-&gt; PA.11  |  LCD_TFT G4 &lt;-&gt; PB.10 |  LCD_TFT B4 &lt;-&gt; PG.12      |
	   |  LCD_TFT R5 &lt;-&gt; PA.12  |  LCD_TFT G5 &lt;-&gt; PB.11 |  LCD_TFT B5 &lt;-&gt; PA.03      |
	   |  LCD_TFT R6 &lt;-&gt; PB.01  |  LCD_TFT G6 &lt;-&gt; PC.07 |  LCD_TFT B6 &lt;-&gt; PB.08      |
	   |  LCD_TFT R7 &lt;-&gt; PG.06  |  LCD_TFT G7 &lt;-&gt; PD.03 |  LCD_TFT B7 &lt;-&gt; PB.09      |
	   -------------------------------------------------------------------------------
	            |  LCD_TFT HSYNC &lt;-&gt; PC.06  | LCDTFT VSYNC &lt;-&gt;  PA.04 |
	            |  LCD_TFT CLK   &lt;-&gt; PG.07  | LCD_TFT DE   &lt;-&gt;  PF.10 |
	             -----------------------------------------------------
	 */

  /* GPIOA configuration */
  GPIO_InitStructure.Pin = GPIO_PIN_3 | GPIO_PIN_4 | GPIO_PIN_6 | GPIO_PIN_11 | GPIO_PIN_12;
  GPIO_InitStructure.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStructure.Pull = GPIO_NOPULL;
  GPIO_InitStructure.Speed = GPIO_SPEED_FAST;
  GPIO_InitStructure.Alternate= GPIO_AF14_LTDC;
  HAL_GPIO_Init(GPIOA, &amp;GPIO_InitStructure);

  /* GPIOB configuration */
  GPIO_InitStructure.Pin = GPIO_PIN_8 | GPIO_PIN_9 | GPIO_PIN_10 | GPIO_PIN_11;
  HAL_GPIO_Init(GPIOB, &amp;GPIO_InitStructure);

  /* GPIOC configuration */
  GPIO_InitStructure.Pin = GPIO_PIN_6 | GPIO_PIN_7 | GPIO_PIN_10;
  HAL_GPIO_Init(GPIOC, &amp;GPIO_InitStructure);

  /* GPIOD configuration */
  GPIO_InitStructure.Pin = GPIO_PIN_3 | GPIO_PIN_6;
  HAL_GPIO_Init(GPIOD, &amp;GPIO_InitStructure);

  /* GPIOF configuration */
  GPIO_InitStructure.Pin = GPIO_PIN_10;
  HAL_GPIO_Init(GPIOF, &amp;GPIO_InitStructure);

  /* GPIOG configuration */
  GPIO_InitStructure.Pin = GPIO_PIN_6 | GPIO_PIN_7 | GPIO_PIN_11;
  HAL_GPIO_Init(GPIOG, &amp;GPIO_InitStructure);

  /* GPIOB configuration */
  GPIO_InitStructure.Pin = GPIO_PIN_0 | GPIO_PIN_1;
  GPIO_InitStructure.Alternate= GPIO_AF9_LTDC;
  HAL_GPIO_Init(GPIOB, &amp;GPIO_InitStructure);

  /* GPIOG configuration */
  GPIO_InitStructure.Pin = GPIO_PIN_10 | GPIO_PIN_12;
  HAL_GPIO_Init(GPIOG, &amp;GPIO_InitStructure);
}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-1">1</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-2">2</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-3">3</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-4">4</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-5">5</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-6">6</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-7">7</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-8">8</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-9">9</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-10">10</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-11">11</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-12">12</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-13">13</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-14">14</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-15">15</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-16">16</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-17">17</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-18">18</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-19">19</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-20">20</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-21">21</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-22">22</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-23">23</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-24">24</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-25">25</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-26">26</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-27">27</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-28">28</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-29">29</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-30">30</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-31">31</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-32">32</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-33">33</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-34">34</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-35">35</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-36">36</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-37">37</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-38">38</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-39">39</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-40">40</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-41">41</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-42">42</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-43">43</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-44">44</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-45">45</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-46">46</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-47">47</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-48">48</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-49">49</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-50">50</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-51">51</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-52">52</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-53">53</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-54">54</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-55">55</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-56">56</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-57">57</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-58">58</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-59">59</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-60">60</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-61">61</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-62">62</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-63">63</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-64">64</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-65">65</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-66">66</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-67">67</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-68">68</div><div class="crayon-num" data-line="crayon-5b10ec5f6f59f432597479-69">69</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-1"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">HAL_LTDC_MspInit</span><span class="crayon-sy">(</span><span class="crayon-e ">LTDC_HandleTypeDef *</span><span class="crayon-v">ltdc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">GPIO_InitTypeDef </span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-4">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* Enable the LTDC clock */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">__HAL_RCC_LTDC_CLK_ENABLE</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-7">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* Enable GPIOs clock */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">__HAL_RCC_GPIOA_CLK_ENABLE</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">__HAL_RCC_GPIOB_CLK_ENABLE</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">__HAL_RCC_GPIOC_CLK_ENABLE</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">__HAL_RCC_GPIOD_CLK_ENABLE</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">__HAL_RCC_GPIOF_CLK_ENABLE</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">__HAL_RCC_GPIOG_CLK_ENABLE</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-15">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-16"><span class="crayon-h">	</span><span class="crayon-c">/* GPIOs Configuration */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-17"><span class="crayon-h">	</span><span class="crayon-c">/*</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-18"><span class="crayon-c">	&nbsp;&nbsp; +------------------------+-----------------------+----------------------------+</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-19"><span class="crayon-c">	&nbsp;&nbsp; +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LCD pins assignment&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-20"><span class="crayon-c">	&nbsp;&nbsp; +------------------------+-----------------------+----------------------------+</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-21"><span class="crayon-c">	&nbsp;&nbsp; |&nbsp;&nbsp;LCD_TFT R2 &lt;-&gt; PC.10&nbsp;&nbsp;|&nbsp;&nbsp;LCD_TFT G2 &lt;-&gt; PA.06 |&nbsp;&nbsp;LCD_TFT B2 &lt;-&gt; PD.06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-22"><span class="crayon-c">	&nbsp;&nbsp; |&nbsp;&nbsp;LCD_TFT R3 &lt;-&gt; PB.00&nbsp;&nbsp;|&nbsp;&nbsp;LCD_TFT G3 &lt;-&gt; PG.10 |&nbsp;&nbsp;LCD_TFT B3 &lt;-&gt; PG.11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-23"><span class="crayon-c">	&nbsp;&nbsp; |&nbsp;&nbsp;LCD_TFT R4 &lt;-&gt; PA.11&nbsp;&nbsp;|&nbsp;&nbsp;LCD_TFT G4 &lt;-&gt; PB.10 |&nbsp;&nbsp;LCD_TFT B4 &lt;-&gt; PG.12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-24"><span class="crayon-c">	&nbsp;&nbsp; |&nbsp;&nbsp;LCD_TFT R5 &lt;-&gt; PA.12&nbsp;&nbsp;|&nbsp;&nbsp;LCD_TFT G5 &lt;-&gt; PB.11 |&nbsp;&nbsp;LCD_TFT B5 &lt;-&gt; PA.03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-25"><span class="crayon-c">	&nbsp;&nbsp; |&nbsp;&nbsp;LCD_TFT R6 &lt;-&gt; PB.01&nbsp;&nbsp;|&nbsp;&nbsp;LCD_TFT G6 &lt;-&gt; PC.07 |&nbsp;&nbsp;LCD_TFT B6 &lt;-&gt; PB.08&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-26"><span class="crayon-c">	&nbsp;&nbsp; |&nbsp;&nbsp;LCD_TFT R7 &lt;-&gt; PG.06&nbsp;&nbsp;|&nbsp;&nbsp;LCD_TFT G7 &lt;-&gt; PD.03 |&nbsp;&nbsp;LCD_TFT B7 &lt;-&gt; PB.09&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-27"><span class="crayon-c">	&nbsp;&nbsp; -------------------------------------------------------------------------------</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-28"><span class="crayon-c">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;LCD_TFT HSYNC &lt;-&gt; PC.06&nbsp;&nbsp;| LCDTFT VSYNC &lt;-&gt;&nbsp;&nbsp;PA.04 |</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-29"><span class="crayon-c">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;LCD_TFT CLK&nbsp;&nbsp; &lt;-&gt; PG.07&nbsp;&nbsp;| LCD_TFT DE&nbsp;&nbsp; &lt;-&gt;&nbsp;&nbsp;PF.10 |</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-30"><span class="crayon-c">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -----------------------------------------------------</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-31"><span class="crayon-c">	 */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-32">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-33"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* GPIOA configuration */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-34"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">.</span><span class="crayon-v">Pin</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_3</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_4</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_6</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_11</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_12</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-35"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">.</span><span class="crayon-v">Mode</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_MODE_AF_PP</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-36"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">.</span><span class="crayon-v">Pull</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_NOPULL</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-37"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">.</span><span class="crayon-v">Speed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_SPEED_FAST</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-38"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">.</span><span class="crayon-v">Alternate</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_AF14_LTDC</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-39"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">HAL_GPIO_Init</span><span class="crayon-sy">(</span><span class="crayon-v">GPIOA</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-40">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-41"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* GPIOB configuration */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-42"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">.</span><span class="crayon-v">Pin</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_8</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_9</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_10</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_11</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-43"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">HAL_GPIO_Init</span><span class="crayon-sy">(</span><span class="crayon-v">GPIOB</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-44">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-45"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* GPIOC configuration */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-46"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">.</span><span class="crayon-v">Pin</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_6</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_7</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_10</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-47"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">HAL_GPIO_Init</span><span class="crayon-sy">(</span><span class="crayon-v">GPIOC</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-48">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-49"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* GPIOD configuration */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-50"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">.</span><span class="crayon-v">Pin</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_3</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_6</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-51"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">HAL_GPIO_Init</span><span class="crayon-sy">(</span><span class="crayon-v">GPIOD</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-52">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-53"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* GPIOF configuration */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-54"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">.</span><span class="crayon-v">Pin</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_10</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-55"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">HAL_GPIO_Init</span><span class="crayon-sy">(</span><span class="crayon-v">GPIOF</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-56">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-57"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* GPIOG configuration */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-58"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">.</span><span class="crayon-v">Pin</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_6</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_7</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_11</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-59"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">HAL_GPIO_Init</span><span class="crayon-sy">(</span><span class="crayon-v">GPIOG</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-60">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-61"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* GPIOB configuration */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-62"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">.</span><span class="crayon-v">Pin</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_0</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-63"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">.</span><span class="crayon-v">Alternate</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_AF9_LTDC</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-64"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">HAL_GPIO_Init</span><span class="crayon-sy">(</span><span class="crayon-v">GPIOB</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-65">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-66"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* GPIOG configuration */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-67"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">.</span><span class="crayon-v">Pin</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_10</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">GPIO_PIN_12</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-68"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">HAL_GPIO_Init</span><span class="crayon-sy">(</span><span class="crayon-v">GPIOG</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">GPIO_InitStructure</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f59f432597479-69"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0060 seconds] -->
<p>To display an image we must convert an image file to an array (possibly a const one, so it can be stored in flash memory) of bytes. To do this I used <strong>LCD image converter</strong>, a simple but powerful application that can convert a file to a variety of different pixel formats:</p>
<div id="attachment_401" style="width: 975px" class="wp-caption aligncenter"><img class="wp-image-401" src="./STM32_ using the LTDC display controller – hello world_files/converter.jpg" alt="" width="965" height="553" srcset="http://www.lucadavidian.com/wp-content/uploads/2017/10/converter.jpg 1269w, http://www.lucadavidian.com/wp-content/uploads/2017/10/converter-300x172.jpg 300w, http://www.lucadavidian.com/wp-content/uploads/2017/10/converter-768x439.jpg 768w, http://www.lucadavidian.com/wp-content/uploads/2017/10/converter-1024x586.jpg 1024w" sizes="(max-width: 965px) 100vw, 965px"><p class="wp-caption-text">figure 6: LTDC image converter is used to generate a RGB888 image array</p></div>
<p>Once the image is converted to a byte array the generated header file is included and the array address can be used as the frame buffer starting address in the <strong>LTDC_LxCFBAR</strong> register. Layer window parameters are configured according to the image size (240 x 320, I rotated the image to fit the display in portrait mode).</p>
<div id="attachment_402" style="width: 942px" class="wp-caption aligncenter"><img class="wp-image-402" src="./STM32_ using the LTDC display controller – hello world_files/image1.jpg" alt="" width="932" height="498" srcset="http://www.lucadavidian.com/wp-content/uploads/2017/10/image1.jpg 4248w, http://www.lucadavidian.com/wp-content/uploads/2017/10/image1-300x160.jpg 300w, http://www.lucadavidian.com/wp-content/uploads/2017/10/image1-768x411.jpg 768w, http://www.lucadavidian.com/wp-content/uploads/2017/10/image1-1024x548.jpg 1024w" sizes="(max-width: 932px) 100vw, 932px"><p class="wp-caption-text">figure 7: a 240 x 320 (rotated) image displayed</p></div>
<p>The second layer can be enabled as well and its contents drawn on top of layer 1. LTDC can manage transparency using the values in the <strong>LTDC_LxCACR</strong> <em>Layer x Constant Alpha Configuration Register</em> and <strong>LTDC_LxBFCR</strong> <em>Layer x Blending Factor Configuration Register</em>: here I used a constant alpha of 255 to obtain a 100% opacity (the value in the constant alpha register is divided by 255 by hardware so for example a value of 128 represents an alpha value of 0.5). Since the layer window is smaller than the display area the default layer background color is set to a transparent black (otherwise the default layer background color is used if the layer window is smaller than the display). The image is 110 x 110 pixels and the pixel format is ARGB8888 (the alpha channel is used to draw transparent pixels).&nbsp;Note that the <strong>LTDC_LxCBLR</strong> and <strong>LTDC_LxCBLNR</strong>&nbsp;registers are configured according to the image size: the LTDC always starts fetching data from the address defined in the&nbsp;<strong>LTDC_LxCFBAR</strong>&nbsp;register. I added the following lines of code to the LTDC_init() function to configure and enable layer 2:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5b10ec5f6f5aa361392715" class="crayon-syntax crayon-theme-powershell crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">/* configure layer 2 */
LTDC_Layer2-&gt;WHPCR = 139 + 20 &lt;&lt; LTDC_LxWHPCR_WHSPPOS_Pos | 30 + 20 &lt;&lt; LTDC_LxWHPCR_WHSTPOS_Pos;   // window horizontal start/stop positions
LTDC_Layer2-&gt;WVPCR = 113 + 200 &lt;&lt; LTDC_LxWVPCR_WVSPPOS_Pos | 4 + 200 &lt;&lt; LTDC_LxWVPCR_WVSTPOS_Pos;  // window vertical start/stop positions
LTDC_Layer2-&gt;PFCR = 0x00;                                                                          // ARGB8888 pixel format
LTDC_Layer2-&gt;DCCR = 0x00 &lt;&lt; LTDC_LxDCCR_DCALPHA_Pos;                                               // layer default color (transparent black)
LTDC_Layer2-&gt;CFBAR = (uint32_t)stamp;                                                              // frame buffer start address
LTDC_Layer2-&gt;CFBLR = 110 * 4 &lt;&lt; LTDC_LxCFBLR_CFBP_Pos | 110 * 4 + 3 &lt;&lt; LTDC_LxCFBLR_CFBLL_Pos;     // frame buffer line length and pitch
LTDC_Layer2-&gt;CFBLNR = 110;                                                                         // frame buffer line number
LTDC_Layer2-&gt;CACR = 255;                                                                           // constant alpha
LTDC_Layer2-&gt;CR |= LTDC_LxCR_LEN;                                                                  // enable Layer2</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row alt">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5b10ec5f6f5aa361392715-1">1</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5aa361392715-2">2</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5aa361392715-3">3</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5aa361392715-4">4</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5aa361392715-5">5</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5aa361392715-6">6</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5aa361392715-7">7</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5aa361392715-8">8</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5aa361392715-9">9</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5aa361392715-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5b10ec5f6f5aa361392715-1"><span class="crayon-c">/* configure layer 2 */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5aa361392715-2"><span class="crayon-v">LTDC_Layer2</span><span class="crayon-o">-&gt;</span><span class="crayon-v">WHPCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">139</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWHPCR_WHSPPOS_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWHPCR_WHSTPOS_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// window horizontal start/stop positions</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5aa361392715-3"><span class="crayon-v">LTDC_Layer2</span><span class="crayon-o">-&gt;</span><span class="crayon-v">WVPCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">113</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWVPCR_WVSPPOS_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWVPCR_WVSTPOS_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// window vertical start/stop positions</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5aa361392715-4"><span class="crayon-v">LTDC_Layer2</span><span class="crayon-o">-&gt;</span><span class="crayon-v">PFCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0x00</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// ARGB8888 pixel format</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5aa361392715-5"><span class="crayon-v">LTDC_Layer2</span><span class="crayon-o">-&gt;</span><span class="crayon-v">DCCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0x00</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxDCCR_DCALPHA_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// layer default color (transparent black)</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5aa361392715-6"><span class="crayon-v">LTDC_Layer2</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CFBAR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">uint32_t</span><span class="crayon-sy">)</span><span class="crayon-v">stamp</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// frame buffer start address</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5aa361392715-7"><span class="crayon-v">LTDC_Layer2</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CFBLR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">110</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxCFBLR_CFBP_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">110</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxCFBLR_CFBLL_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// frame buffer line length and pitch</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5aa361392715-8"><span class="crayon-v">LTDC_Layer2</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CFBLNR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">110</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// frame buffer line number</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5aa361392715-9"><span class="crayon-v">LTDC_Layer2</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CACR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// constant alpha</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5aa361392715-10"><span class="crayon-v">LTDC_Layer2</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CR</span><span class="crayon-h"> </span><span class="crayon-o">|=</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxCR_LEN</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// enable Layer2</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0030 seconds] -->
<p>&nbsp;</p>
<div id="attachment_403" style="width: 972px" class="wp-caption aligncenter"><img class="wp-image-403" src="./STM32_ using the LTDC display controller – hello world_files/image2.jpg" alt="" width="962" height="549" srcset="http://www.lucadavidian.com/wp-content/uploads/2017/10/image2.jpg 4544w, http://www.lucadavidian.com/wp-content/uploads/2017/10/image2-300x171.jpg 300w, http://www.lucadavidian.com/wp-content/uploads/2017/10/image2-768x438.jpg 768w, http://www.lucadavidian.com/wp-content/uploads/2017/10/image2-1024x584.jpg 1024w" sizes="(max-width: 962px) 100vw, 962px"><p class="wp-caption-text">figure 8: the layer window must be inside the active display area. layer2 image is in ARGB8888 format, allowing tranparent pixels to show through</p></div>
<p>If we want do display portion of an image, we must configure <strong>LTDC_LxCBLR</strong> and <strong>LTDC_LxCBLNR</strong> accordingly:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5b10ec5f6f5b1059926207" class="crayon-syntax crayon-theme-powershell crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">/* configure layer 1 */
LTDC_Layer1-&gt;WHPCR = 129 + 50 &lt;&lt; LTDC_LxWHPCR_WHSPPOS_Pos | 30 + 50 &lt;&lt; LTDC_LxWHPCR_WHSTPOS_Pos;          // window horizontal start/stop positions
LTDC_Layer1-&gt;WVPCR = 103 + 50 &lt;&lt; LTDC_LxWVPCR_WVSPPOS_Pos | 4 + 50 &lt;&lt; LTDC_LxWVPCR_WVSTPOS_Pos;           // window vertical start/stop positions
LTDC_Layer1-&gt;PFCR = 0x01;   // RGB888 pixel format
LTDC_Layer1-&gt;DCCR = 0xFF &lt;&lt; LTDC_LxDCCR_DCALPHA_Pos | 0xFF &lt;&lt; LTDC_LxDCCR_DCGREEN_Pos;          // layer default color
LTDC_Layer1-&gt;CFBAR = (uint32_t)image;                                                           // frame buffer start address
LTDC_Layer1-&gt;CFBLR = 240 * 3 &lt;&lt; LTDC_LxCFBLR_CFBP_Pos | 100 * 3 + 3 &lt;&lt; LTDC_LxCFBLR_CFBLL_Pos;  // frame buffer line length and pitch
LTDC_Layer1-&gt;CFBLNR = 100;                                                                      // frame buffer line number
LTDC_Layer1-&gt;CACR = 255;                                                                        // constant alpha</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5b10ec5f6f5b1059926207-1">1</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b1059926207-2">2</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b1059926207-3">3</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b1059926207-4">4</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b1059926207-5">5</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b1059926207-6">6</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b1059926207-7">7</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b1059926207-8">8</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b1059926207-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5b10ec5f6f5b1059926207-1"><span class="crayon-c">/* configure layer 1 */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b1059926207-2"><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">WHPCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">129</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWHPCR_WHSPPOS_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWHPCR_WHSTPOS_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// window horizontal start/stop positions</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b1059926207-3"><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">WVPCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">103</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWVPCR_WVSPPOS_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWVPCR_WVSTPOS_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// window vertical start/stop positions</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b1059926207-4"><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">PFCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0x01</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// RGB888 pixel format</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b1059926207-5"><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">DCCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxDCCR_DCALPHA_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxDCCR_DCGREEN_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// layer default color</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b1059926207-6"><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CFBAR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">uint32_t</span><span class="crayon-sy">)</span><span class="crayon-v">image</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// frame buffer start address</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b1059926207-7"><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CFBLR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">240</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxCFBLR_CFBP_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxCFBLR_CFBLL_Pos</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// frame buffer line length and pitch</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b1059926207-8"><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CFBLNR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// frame buffer line number</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b1059926207-9"><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CACR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// constant alpha</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0045 seconds] -->
<p>Now I’m just showing 100 x 100 pixels of the layer 1 image so I configured the color buffer line length as 100 and the color buffer number of lines as 100. The line pitch value indicates that a framebuffer line is still 240 * 3 bytes long so the controller knows how to fetch bytes from the frame buffer correctly. I also moved the start of the window adding an offset of 50 pixels and 50 scan lines. The default background color is used where the layer isn’t used (the layer background color is a solid green):</p>
<div id="attachment_405" style="width: 971px" class="wp-caption aligncenter"><img class="wp-image-405" src="./STM32_ using the LTDC display controller – hello world_files/image3.jpg" alt="" width="961" height="585" srcset="http://www.lucadavidian.com/wp-content/uploads/2017/10/image3.jpg 3760w, http://www.lucadavidian.com/wp-content/uploads/2017/10/image3-300x183.jpg 300w, http://www.lucadavidian.com/wp-content/uploads/2017/10/image3-768x468.jpg 768w, http://www.lucadavidian.com/wp-content/uploads/2017/10/image3-1024x623.jpg 1024w" sizes="(max-width: 961px) 100vw, 961px"><p class="wp-caption-text">figure 9: layer1 window is resized and repositioned inside active display area</p></div>
<p>Using two layers and playing with the layer window size and position allows to create simple animations by simply moving the layer window around the frame:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5b10ec5f6f5b9592000082" class="crayon-syntax crayon-theme-powershell crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">#define SIZE                 110
#define DISPLAY_WIDTH        240
#define DISPLAY_HEIGHT       320
#define ACTIVE_AREA_START_X   30
#define ACTIVE_AREA_START_Y    4

int main(void)
{
  HAL_Init();
  system_clock_config();
  ILI9341_init();
  LTDC_init();

  double x_offset = 10;
  double y_offset = 10;
  double vx = 0.1;
  double vy = 0.1;

  for(;;)
  {
    if (x_offset &lt;= 0 || x_offset + SIZE &gt;= DISPLAY_WIDTH)
      vx = -vx;
    if (y_offset &lt;= 0 || y_offset + SIZE &gt;= DISPLAY_HEIGHT)
      vy = -vy;
    x_offset += vx;
    y_offset += vy;
    LTDC_Layer2-&gt;WHPCR = ACTIVE_AREA_START_X + SIZE + (int)x_offset - 1 &lt;&lt; LTDC_LxWHPCR_WHSPPOS_Pos | ACTIVE_AREA_START_X + (int)x_offset &lt;&lt; LTDC_LxWHPCR_WHSTPOS_Pos;
    LTDC_Layer2-&gt;WVPCR = ACTIVE_AREA_START_Y + SIZE + (int)y_offset - 1 &lt;&lt; LTDC_LxWVPCR_WVSPPOS_Pos | ACTIVE_AREA_START_Y + (int)y_offset &lt;&lt; LTDC_LxWVPCR_WVSTPOS_Pos;
    LTDC-&gt;SRCR = LTDC_SRCR_VBR;                      // reload shadow registers on vertical blanking period
    while ((LTDC-&gt;CDSR &amp; LTDC_CDSR_VSYNCS) == 0)     // wait for next frame
	;
    while ((LTDC-&gt;CDSR &amp; LTDC_CDSR_VSYNCS) == 1)
	;
  }
}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row alt">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-1">1</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-2">2</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-3">3</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-4">4</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-5">5</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-6">6</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-7">7</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-8">8</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-9">9</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-10">10</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-11">11</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-12">12</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-13">13</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-14">14</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-15">15</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-16">16</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-17">17</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-18">18</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-19">19</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-20">20</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-21">21</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-22">22</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-23">23</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-24">24</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-25">25</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-26">26</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-27">27</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-28">28</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-29">29</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-30">30</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-31">31</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-32">32</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-33">33</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-34">34</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5b9592000082-35">35</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-1"><span class="crayon-p">#define SIZE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 110</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-2"><span class="crayon-p">#define DISPLAY_WIDTH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;240</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-3"><span class="crayon-p">#define DISPLAY_HEIGHT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 320</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-4"><span class="crayon-p">#define ACTIVE_AREA_START_X&nbsp;&nbsp; 30</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-5"><span class="crayon-p">#define ACTIVE_AREA_START_Y&nbsp;&nbsp;&nbsp;&nbsp;4</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-6">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-7"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-t">void</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-8"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">HAL_Init</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">system_clock_config</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">ILI9341_init</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">LTDC_init</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-13">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">double</span><span class="crayon-h"> </span><span class="crayon-v">x_offset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">double</span><span class="crayon-h"> </span><span class="crayon-v">y_offset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">double</span><span class="crayon-h"> </span><span class="crayon-v">vx</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">double</span><span class="crayon-h"> </span><span class="crayon-v">vy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-18">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">x_offset</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">x_offset</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">SIZE</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">DISPLAY_WIDTH</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">vx</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">vx</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">y_offset</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">y_offset</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">SIZE</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">DISPLAY_HEIGHT</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">vy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">vy</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x_offset</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">vx</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">y_offset</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">vy</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LTDC_Layer2</span><span class="crayon-o">-&gt;</span><span class="crayon-v">WHPCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ACTIVE_AREA_START_X</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">SIZE</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">)</span><span class="crayon-v">x_offset</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWHPCR_WHSPPOS_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">ACTIVE_AREA_START_X</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">)</span><span class="crayon-v">x_offset</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWHPCR_WHSTPOS_Pos</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LTDC_Layer2</span><span class="crayon-o">-&gt;</span><span class="crayon-v">WVPCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ACTIVE_AREA_START_Y</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">SIZE</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">)</span><span class="crayon-v">y_offset</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWVPCR_WVSPPOS_Pos</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">ACTIVE_AREA_START_Y</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">)</span><span class="crayon-v">y_offset</span><span class="crayon-h"> </span><span class="crayon-o">&lt;&lt;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_LxWVPCR_WVSTPOS_Pos</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">SRCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_SRCR_VBR</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// reload shadow registers on vertical blanking period</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CDSR</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_CDSR_VSYNCS</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// wait for next frame</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-31"><span class="crayon-h">	</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CDSR</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_CDSR_VSYNCS</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-33"><span class="crayon-h">	</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-34"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5b9592000082-35"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0047 seconds] -->
<p>Shadow configuration registers are reloaded each vertical blanking period (after the last line has been drawn) and the code waits for the next frame by polling the <strong>VSYNCS</strong> flag of the <strong>LTDC_CDSR</strong> <em>Current Display Status Register</em>, whose bits contain the state of the synchronization signals (high if they’re asserted, no matter the polarity configured). Running the code we get a nice smooth animation:</p>
<p><img class="size-full wp-image-406 aligncenter" src="./STM32_ using the LTDC display controller – hello world_files/WP_20171002_13_02_56_Pro.gif" alt="" width="600" height="338"></p>
<h3>LTDC interrupts</h3>
<p>The LTDC controller has four interrupts logically OR-ed into two interrupt request lines:</p>
<ul>
<li><strong>Register Reload Interrupt</strong>, generated as soon as the shadow registers are reloaded</li>
<li><strong>Line Interrupt</strong>, generated when a line number (programmed into <strong>LTDC_LIPCR</strong> <em>Line Interrupt Position Control Register</em>) is reached</li>
<li><strong>Transfer Error Interrupt</strong>, generated when an AHB bus error occurs during a transfer</li>
<li><strong>FIFO underrun Interrupt</strong>, generated when a pixel is requested from an empty layer FIFO</li>
</ul>
<div id="attachment_418" style="width: 956px" class="wp-caption aligncenter"><img class="wp-image-418" src="./STM32_ using the LTDC display controller – hello world_files/interrupts__.jpg" alt="" width="946" height="270" srcset="http://www.lucadavidian.com/wp-content/uploads/2017/10/interrupts__.jpg 978w, http://www.lucadavidian.com/wp-content/uploads/2017/10/interrupts__-300x86.jpg 300w, http://www.lucadavidian.com/wp-content/uploads/2017/10/interrupts__-768x219.jpg 768w" sizes="(max-width: 946px) 100vw, 946px"><p class="wp-caption-text">figure 10: LTDC interrupts and IRQ lines</p></div>
<p>The Line and Register Reload interrupts are useful to synchronize the code with the controller.</p>
<h3>Using double buffering</h3>
<p>Double buffer is used when we want the code to write on a frame buffer while another buffer is being read by the LTDC. This avoids corrupting the data being displayed on the screen. The buffers are switched during the vertical blanking period using polling or interrupts.</p>
<div id="attachment_411" style="width: 911px" class="wp-caption aligncenter"><img class="wp-image-411" src="./STM32_ using the LTDC display controller – hello world_files/Untitled-Diagram.jpg" alt="" width="901" height="906" srcset="http://www.lucadavidian.com/wp-content/uploads/2017/10/Untitled-Diagram.jpg 1489w, http://www.lucadavidian.com/wp-content/uploads/2017/10/Untitled-Diagram-150x150.jpg 150w, http://www.lucadavidian.com/wp-content/uploads/2017/10/Untitled-Diagram-768x772.jpg 768w, http://www.lucadavidian.com/wp-content/uploads/2017/10/Untitled-Diagram-1019x1024.jpg 1019w, http://www.lucadavidian.com/wp-content/uploads/2017/10/Untitled-Diagram-160x160.jpg 160w" sizes="(max-width: 901px) 100vw, 901px"><p class="wp-caption-text">figure n: while the code writes to the back buffer the LTDC fetches data from the front (active) buffer. Famebuffers are switched during vertical blanking period.</p></div>
<p>In this example the framebuffers have a RGB888 color depth and for a 240×320 display that makes 225 KiB of memory for each buffer (3 bytes per pixel x 240 x 320 pixels) so they must be stored in external SRAM (the STM32F429I-DISCOVERY has a 64Mbit external SRAM so we’re good). The <strong>FMC</strong> <em>Flexible Memory Controller</em> has to be initialized and the address of the two frame buffers has to be configured. Drawing on the framebuffer is a matter of writing the right bytes in order to change the color. Once all pixels are drawn (bytes are written) the buffers are switched and the code can draw the next frame:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5b10ec5f6f5c2901006119" class="crayon-syntax crayon-theme-powershell crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">#define SDRAM_ADDR                               ((uint32_t)0xD0000000)                 // SDRAM bank 2 FMC address

/* double buffering (RGB888 frame buffer) */
#define FRAMEBUFFER_SIZE                         (DISPLAY_WIDTH * DISPLAY_HEIGHT * 3)
#define FRAMEBUFFER1_ADDR                        (SDRAM_ADDR)                           // frame buffer 1 address (external RAM)
#define FRAMEBUFFER2_ADDR                        (SDRAM_ADDR + FRAMEBUFFER_SIZE)        // frame buffer 2 address (external RAM)

enum framebuffer
{
  FRAMEBUFFER1,FRAMEBUFFER2
};

static enum framebuffer active = FRAMEBUFFER1;

void LTDC_init(void)
{
  /* initialize SDRAM */
  SDRAM_init();

  /* fill framebuffers with black */
  for (int i = 0 ; i &lt; DISPLAY_WIDTH * DISPLAY_HEIGHT * 3 ; i++)
  	((int8_t*)FRAMEBUFFER1_ADDR)[i] = 0x00;
  for (int i = 0 ; i &lt; DISPLAY_WIDTH * DISPLAY_HEIGHT * 3 ; i++)
	((int8_t*)FRAMEBUFFER2_ADDR)[i] = 0x00;

  /* LTDC initialization code */
  /* .................. */

  /* layer1 initialization code */
  /* .................. */
  LTDC_Layer1-&gt;CFBAR = FRAMEBUFFER1_ADDR;    // frame buffer 1 is the front buffer
  active = FRAMEBUFFER1;

  /* other LTDC initialization code */
  /* .................. */
}

void LTDC_switch_framebuffer(void)
{
  if (active == FRAMEBUFFER1)
  {
  	LTDC_Layer1-&gt;CFBAR = FRAMEBUFFER2_ADDR;
	active = FRAMEBUFFER2;
  }
  else
  {
	LTDC_Layer1-&gt;CFBAR = FRAMEBUFFER1_ADDR;
	active = FRAMEBUFFER1;
  }
  LTDC-&gt;SRCR = LTDC_SRCR_VBR;                     // reload shadow registers on vertical blank
  while ((LTDC-&gt;CDSR &amp; LTDC_CDSR_VSYNCS) == 0)    // wait for reload
	;
}

uint8_t *LTDC_get_backbuffer_address(void)
{
  if (active == FRAMEBUFFER1)
	return (int8_t*)FRAMEBUFFER2_ADDR;
  else
	return (int8_t*)FRAMEBUFFER1_ADDR;
}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-2">2</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-4">4</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-6">6</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-8">8</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-10">10</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-12">12</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-14">14</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-16">16</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-18">18</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-20">20</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-22">22</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-24">24</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-26">26</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-28">28</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-30">30</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-32">32</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-34">34</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-36">36</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-38">38</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-40">40</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-42">42</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-44">44</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-46">46</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-48">48</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-50">50</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-52">52</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-54">54</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-56">56</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-58">58</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5b10ec5f6f5c2901006119-60">60</div><div class="crayon-num" data-line="crayon-5b10ec5f6f5c2901006119-61">61</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-1"><span class="crayon-p">#define SDRAM_ADDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((uint32_t)0xD0000000)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // SDRAM bank 2 FMC address</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-2">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-3"><span class="crayon-c">/* double buffering (RGB888 frame buffer) */</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-4"><span class="crayon-p">#define FRAMEBUFFER_SIZE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (DISPLAY_WIDTH * DISPLAY_HEIGHT * 3)</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-5"><span class="crayon-p">#define FRAMEBUFFER1_ADDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(SDRAM_ADDR)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // frame buffer 1 address (external RAM)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-6"><span class="crayon-p">#define FRAMEBUFFER2_ADDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(SDRAM_ADDR + FRAMEBUFFER_SIZE)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// frame buffer 2 address (external RAM)</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-8"><span class="crayon-t">enum</span><span class="crayon-h"> </span><span class="crayon-e">framebuffer</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-9"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">FRAMEBUFFER1</span><span class="crayon-sy">,</span><span class="crayon-i">FRAMEBUFFER2</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-11"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-12">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-13"><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-t">enum</span><span class="crayon-h"> </span><span class="crayon-e">framebuffer </span><span class="crayon-v">active</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">FRAMEBUFFER1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-14">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-15"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">LTDC_init</span><span class="crayon-sy">(</span><span class="crayon-t">void</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-16"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* initialize SDRAM */</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">SDRAM_init</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* fill framebuffers with black */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-21"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-e ">DISPLAY_WIDTH *</span><span class="crayon-h"> </span><span class="crayon-e ">DISPLAY_HEIGHT *</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-o">++</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-22"><span class="crayon-h">&nbsp;&nbsp;	</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e ">int8_t*</span><span class="crayon-sy">)</span><span class="crayon-v">FRAMEBUFFER1_ADDR</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0x00</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-23"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-e ">DISPLAY_WIDTH *</span><span class="crayon-h"> </span><span class="crayon-e ">DISPLAY_HEIGHT *</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-o">++</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-24"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e ">int8_t*</span><span class="crayon-sy">)</span><span class="crayon-v">FRAMEBUFFER2_ADDR</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0x00</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-26"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* LTDC initialization code */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-27"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* .................. */</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-28">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-29"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* layer1 initialization code */</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-30"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* .................. */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-31"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CFBAR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">FRAMEBUFFER1_ADDR</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// frame buffer 1 is the front buffer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-32"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">active</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">FRAMEBUFFER1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-34"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* other LTDC initialization code */</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-35"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">/* .................. */</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-36"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-38"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">LTDC_switch_framebuffer</span><span class="crayon-sy">(</span><span class="crayon-t">void</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-39"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-40"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">active</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">FRAMEBUFFER1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-41"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-42"><span class="crayon-h">&nbsp;&nbsp;	</span><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CFBAR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">FRAMEBUFFER2_ADDR</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-43"><span class="crayon-h">	</span><span class="crayon-v">active</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">FRAMEBUFFER2</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-44"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-45"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">else</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-46"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-47"><span class="crayon-h">	</span><span class="crayon-v">LTDC_Layer1</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CFBAR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">FRAMEBUFFER1_ADDR</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-48"><span class="crayon-h">	</span><span class="crayon-v">active</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">FRAMEBUFFER1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-49"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-50"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">SRCR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_SRCR_VBR</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// reload shadow registers on vertical blank</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-51"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">LTDC</span><span class="crayon-o">-&gt;</span><span class="crayon-v">CDSR</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-v">LTDC_CDSR_VSYNCS</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// wait for reload</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-52"><span class="crayon-h">	</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-53"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-54">&nbsp;</div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-55"><span class="crayon-e ">uint8_t *</span><span class="crayon-e">LTDC_get_backbuffer_address</span><span class="crayon-sy">(</span><span class="crayon-t">void</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-56"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-57"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">active</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">FRAMEBUFFER1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-58"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">int8_t*</span><span class="crayon-sy">)</span><span class="crayon-v">FRAMEBUFFER2_ADDR</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-59"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">else</span></div><div class="crayon-line crayon-striped-line" id="crayon-5b10ec5f6f5c2901006119-60"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">int8_t*</span><span class="crayon-sy">)</span><span class="crayon-v">FRAMEBUFFER1_ADDR</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5b10ec5f6f5c2901006119-61"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0049 seconds] -->
<p>Now as soon as a frame is done with, calling LTDC_switch_framebuffer() waits for the vertical synchronization period and swaps the buffers. If the code is faster than the display refresh rate (70Hz in our case) it waits for the LTDC to complete drawing the frame.</p>
<p>In the next post I’m going to use the double buffer technique to draw and animate sprites.</p>
<p><a href="http://www.lucadavidian.com/wp-content/uploads/2017/10/LTDC.zip">source code</a></p>
<p><a href="http://www.lucadavidian.com/wp-content/uploads/2017/10/LTDC-display-controller.pdf" target="_blank" rel="noopener">LTDC datasheet</a></p>
          <nav class="pagination group">
                      </nav><!--/.pagination-->
        </div>

        
        <div class="clear"></div>
      </div><!--/.entry-->

    </div><!--/.post-inner-->
  </article><!--/.post-->

<div class="clear"></div>






<section id="comments" class="themeform">

	
		<h3 class="heading">10 Responses</h3>

		<ul class="comment-tabs group">
			<li class="active"><a href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/#commentlist-container"><i class="fa fa-comments-o"></i>Comments<span>10</span></a></li>
			<li><a href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/#pinglist-container"><i class="fa fa-share"></i>Pingbacks<span>0</span></a></li>
		</ul>

				<div id="commentlist-container" class="comment-tab">

			<ol class="commentlist">
						<li class="comment even thread-even depth-1 parent" id="comment-10">
				<div id="div-comment-10" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="./STM32_ using the LTDC display controller – hello world_files/19e71342c2ad691a965ae1769bc085bc.png" srcset="http://1.gravatar.com/avatar/19e71342c2ad691a965ae1769bc085bc?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">			<cite class="fn">Sunnipaul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/#comment-10">
			November 14, 2017 at 8:05 am</a>		</div>

		<p>Hello,</p>
<p>Thank you for your sharing.<br>
I copied and ran your code. But it only works when starting sing step debug from here:<br>
 	ILI9341_write_command(ILI9341_DISPLAY_FUNCTION_CONTROL);<br>
until the end of the function ILI9341_Init.  Otherwise it will show white screen.</p>
<p>Could you please help me figure out why?</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-link" href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/?replytocom=10#respond" onclick="return addComment.moveForm( &quot;div-comment-10&quot;, &quot;10&quot;, &quot;respond&quot;, &quot;359&quot; )" aria-label="Reply to Sunnipaul">Reply</a></div>
				</div>
		<ul class="children">
		<li class="comment byuser comment-author-wp_8383403 bypostauthor odd alt depth-2" id="comment-12">
				<div id="div-comment-12" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="./STM32_ using the LTDC display controller – hello world_files/7e5e7e0cf5821642d3eaf1820240d7d5.png" srcset="http://1.gravatar.com/avatar/7e5e7e0cf5821642d3eaf1820240d7d5?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">			<cite class="fn">Luca Davidian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/#comment-12">
			November 14, 2017 at 9:49 am</a>		</div>

		<p>if it works when you single step during debugging must be a timing issue in the init sequence for the display. Do you initialize the clock system correctly in your main? Have you tried modifying the HAL_Delay() call at the end of the sequence?</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-link" href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/?replytocom=12#respond" onclick="return addComment.moveForm( &quot;div-comment-12&quot;, &quot;12&quot;, &quot;respond&quot;, &quot;359&quot; )" aria-label="Reply to Luca Davidian">Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-14">
				<div id="div-comment-14" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="./STM32_ using the LTDC display controller – hello world_files/19e71342c2ad691a965ae1769bc085bc.png" srcset="http://1.gravatar.com/avatar/19e71342c2ad691a965ae1769bc085bc?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">			<cite class="fn">Sunnipaul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/#comment-14">
			November 15, 2017 at 12:56 am</a>		</div>

		<p>Thank you for your suggestion.</p>
<p>I indeed added several HAL_Delays (also made delay longer) among the sequence. It gave the same white screen result.<br>
I asked someone else for help. He added delays after every ili9341_send_command and ili9341_send_data  function then it worked. He explained to me that F429 is too fast for the screen to respond.</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-link" href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/?replytocom=14#respond" onclick="return addComment.moveForm( &quot;div-comment-14&quot;, &quot;14&quot;, &quot;respond&quot;, &quot;359&quot; )" aria-label="Reply to Sunnipaul">Reply</a></div>
				</div>
		<ul class="children">
		<li class="comment byuser comment-author-wp_8383403 bypostauthor odd alt depth-2 parent" id="comment-15">
				<div id="div-comment-15" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="./STM32_ using the LTDC display controller – hello world_files/7e5e7e0cf5821642d3eaf1820240d7d5.png" srcset="http://1.gravatar.com/avatar/7e5e7e0cf5821642d3eaf1820240d7d5?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">			<cite class="fn">Luca Davidian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/#comment-15">
			November 15, 2017 at 11:49 am</a>		</div>

		<p>Speed of the micro is not an issue, as long as you respect the timings provided in the datasheet of the device you are driving. I experimented quite a bit with the initialization sequence and came up with a working sequence of commands. Are you using the same STM32 discovery board (and microcontroller) as I am? Did you double-check the clock system initialization routine?</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-link" href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/?replytocom=15#respond" onclick="return addComment.moveForm( &quot;div-comment-15&quot;, &quot;15&quot;, &quot;respond&quot;, &quot;359&quot; )" aria-label="Reply to Luca Davidian">Reply</a></div>
				</div>
		<ul class="children">
		<li class="comment even depth-3 parent" id="comment-17">
				<div id="div-comment-17" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="./STM32_ using the LTDC display controller – hello world_files/19e71342c2ad691a965ae1769bc085bc.png" srcset="http://1.gravatar.com/avatar/19e71342c2ad691a965ae1769bc085bc?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">			<cite class="fn">sunnipaul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/#comment-17">
			November 17, 2017 at 1:22 am</a>		</div>

		<p>I’ve remove the delay function calls and changed Spi_transmit to HAL_SPI_Transmit instead. It worked then.<br>
However the HAL_SPI_Transmit has more than 100 lines of code.  Which is also a considerable delay. </p>
<p>Here is the system_config I used:</p>
<p><code></code><code></code></p><code>
<p>void system_clock_config(void)<br>
{<br>
  RCC_OscInitTypeDef RCC_OscInitStruct;<br>
  RCC_ClkInitTypeDef RCC_ClkInitStruct;<br>
  RCC_PeriphCLKInitTypeDef PeriphClkInitStruct;</p>
<p>    /**Configure the main internal regulator output voltage<br>
    */<br>
  __HAL_RCC_PWR_CLK_ENABLE();</p>
<p>  __HAL_PWR_VOLTAGESCALING_CONFIG(PWR_REGULATOR_VOLTAGE_SCALE1);</p>
<p>    /**Initializes the CPU, AHB and APB busses clocks<br>
    */<br>
  RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_HSI;<br>
  RCC_OscInitStruct.HSIState = RCC_HSI_ON;<br>
  RCC_OscInitStruct.HSICalibrationValue = 16;<br>
  RCC_OscInitStruct.PLL.PLLState = RCC_PLL_ON;<br>
  RCC_OscInitStruct.PLL.PLLSource = RCC_PLLSOURCE_HSI;<br>
  RCC_OscInitStruct.PLL.PLLM = 8;<br>
  RCC_OscInitStruct.PLL.PLLN = 180;<br>
  RCC_OscInitStruct.PLL.PLLP = RCC_PLLP_DIV2;<br>
  RCC_OscInitStruct.PLL.PLLQ = 7;<br>
  HAL_RCC_OscConfig(&amp;RCC_OscInitStruct);</p>
<p>    /**Activate the Over-Drive mode<br>
    */<br>
  HAL_PWREx_EnableOverDrive();</p>
<p>    /**Initializes the CPU, AHB and APB busses clocks<br>
    */<br>
  RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_HCLK|RCC_CLOCKTYPE_SYSCLK|RCC_CLOCKTYPE_PCLK1|RCC_CLOCKTYPE_PCLK2;<br>
  RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;<br>
  RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;<br>
  RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV4;<br>
  RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV2;</p>
<p>  HAL_RCC_ClockConfig(&amp;RCC_ClkInitStruct, FLASH_LATENCY_5);</p>
<p>  PeriphClkInitStruct.PeriphClockSelection = RCC_PERIPHCLK_LTDC;<br>
  PeriphClkInitStruct.PLLSAI.PLLSAIN = 60;<br>
  PeriphClkInitStruct.PLLSAI.PLLSAIR = 5;<br>
  PeriphClkInitStruct.PLLSAIDivR = RCC_PLLSAIDIVR_4;<br>
  HAL_RCCEx_PeriphCLKConfig(&amp;PeriphClkInitStruct);<br>
}</p>
</code><p><code></code><code></code></p>

		<div class="reply"><a rel="nofollow" class="comment-reply-link" href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/?replytocom=17#respond" onclick="return addComment.moveForm( &quot;div-comment-17&quot;, &quot;17&quot;, &quot;respond&quot;, &quot;359&quot; )" aria-label="Reply to sunnipaul">Reply</a></div>
				</div>
		<ul class="children">
		<li class="comment byuser comment-author-wp_8383403 bypostauthor odd alt depth-4" id="comment-19">
				<div id="div-comment-19" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="./STM32_ using the LTDC display controller – hello world_files/7e5e7e0cf5821642d3eaf1820240d7d5.png" srcset="http://1.gravatar.com/avatar/7e5e7e0cf5821642d3eaf1820240d7d5?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">			<cite class="fn">Luca Davidian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/#comment-19">
			November 17, 2017 at 4:21 pm</a>		</div>

		<p>I downloaded the source code from the page and created a new project with those same files. I added the relevant STM32CubeHAL and CMSIS files and it works on my STM32F429Discovery. Which IDE are you using? Are you using the same board or are you on a different micro? Did you check the display connections?</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-link" href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/?replytocom=19#respond" onclick="return addComment.moveForm( &quot;div-comment-19&quot;, &quot;19&quot;, &quot;respond&quot;, &quot;359&quot; )" aria-label="Reply to Luca Davidian">Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-33">
				<div id="div-comment-33" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="./STM32_ using the LTDC display controller – hello world_files/b97f37dc0d66752a262e119475a1b2e3.png" srcset="http://2.gravatar.com/avatar/b97f37dc0d66752a262e119475a1b2e3?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">			<cite class="fn">Bernd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/#comment-33">
			January 24, 2018 at 11:42 am</a>		</div>

		<p>Hey Luca,<br>
Thanks for sharing this. It helped me to understand the configuration of the LTDC and the layer concept.<br>
I still have one problem and wonder if you can point me in the right direction.<br>
My demo project is from another source but the basic things are set up and the display is working.<br>
A background image (in display resolution) is shown on layer 1 and tried to only show a part of it as you did in figure 9.<br>
Only the part with the cathedral dome is visible. If I try to setup something similar, I see the upper left corner of the full image (in the wanted size of the partial viewing area) shifted to the wanted position. I have absolutely no clue what I do wrong. From your description I understood that I have to set line length and number of lines to fit my wanted partial viewing area size. I set up the X and Y offset of the parial viewing area which works as expexted. The link to the framebuffer still points to the beginning of the image array and the pitch still fits to the full image width. So with this information the LTDC should pic the correct part from the image array, but in my case it always pics the part starting from upper left corner which is (0/0). Any idea?</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-link" href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/?replytocom=33#respond" onclick="return addComment.moveForm( &quot;div-comment-33&quot;, &quot;33&quot;, &quot;respond&quot;, &quot;359&quot; )" aria-label="Reply to Bernd">Reply</a></div>
				</div>
		<ul class="children">
		<li class="comment byuser comment-author-wp_8383403 bypostauthor odd alt depth-2 parent" id="comment-37">
				<div id="div-comment-37" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="./STM32_ using the LTDC display controller – hello world_files/7e5e7e0cf5821642d3eaf1820240d7d5.png" srcset="http://1.gravatar.com/avatar/7e5e7e0cf5821642d3eaf1820240d7d5?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">			<cite class="fn">Luca Davidian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/#comment-37">
			February 2, 2018 at 7:11 pm</a>		</div>

		<p>Hi Bernd. The window horizontal and vertical start and stop positions represent respectively the first and the last pixels and the first and the last lines of the image that are displayed on the screen inside the active area of the display (that’s why you take into consideration the horizontal and vertical back porch timing parameters). The LTDC always starts fetching data from the beginning of the frame buffer base address in LTDC_LxCFBAR register. The line length, line pitch and number of lines parameters are used by the LTDC to know how many bytes to fetch from the buffer, so if you want to display a portion of the image you have to program the line length and the number of lines accordingly (the line pitch is always the number of bytes in one line). Note that the parameters in LTDC_LxCFBLR register are in units of bytes, so you must take into account the color format of the image pixels (bytes per pixel, 3 for a RGB image). So if you’re displaying a partial image in a window it’ll always show the upper left corner of the image. To display an actual window (a kind of “viewport”) inside your image you have to shift the base address of the frame buffer in the following way: </p>
<p><em>base address + ((start_x + start_y * DISPLAY_WIDTH) * BPP)</em> </p>
<p>Where BPP stands for bytes per pixels and depends on the color format. In this case you’ll get a window inside the image as if the the entire image was displayed on the whole screen, but only a portion is shown. Try this snippet, it should display the lower right corner of the image:</p>
<p><code>/* configure layer 1 */<br>
LTDC_Layer1-&gt;WHPCR = 269 &lt; &lt; LTDC_LxWHPCR_WHSPPOS_Pos | 30 + 200 &lt;&lt; LTDC_LxWHPCR_WHSTPOS_Pos;  // window horizontal start/stop positions
LTDC_Layer1-&gt;WVPCR = 323 &lt; &lt; LTDC_LxWVPCR_WVSPPOS_Pos | 4 + 200 &lt;&lt; LTDC_LxWVPCR_WVSTPOS_Pos;  // window vertical start/stop positions
LTDC_Layer1-&gt;PFCR = 0x01;   // RGB888 pixel format<br>
LTDC_Layer1-&gt;DCCR = 0xFF &lt; &lt; LTDC_LxDCCR_DCALPHA_Pos | 0xFF &lt;&lt; LTDC_LxDCCR_DCGREEN_Pos;   // layer default color
LTDC_Layer1-&gt;CFBAR = (uint32_t)(rome + (200 + 200 * 240) * 3);                          // frame buffer start address (SHIFTED)<br>
LTDC_Layer1-&gt;CFBLR = 240 * 3 &lt; &lt; LTDC_LxCFBLR_CFBP_Pos | 40 * 3 + 3 &lt;&lt; LTDC_LxCFBLR_CFBLL_Pos;  // frame buffer line length and pitch
LTDC_Layer1-&gt;CFBLNR = 120;         // frame buffer line number<br>
LTDC_Layer1-&gt;CACR = 255;           // constant alpha<br>
LTDC_Layer1-&gt;CR |= LTDC_LxCR_LEN;  // enable Layer1</code></p>

		<div class="reply"><a rel="nofollow" class="comment-reply-link" href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/?replytocom=37#respond" onclick="return addComment.moveForm( &quot;div-comment-37&quot;, &quot;37&quot;, &quot;respond&quot;, &quot;359&quot; )" aria-label="Reply to Luca Davidian">Reply</a></div>
				</div>
		<ul class="children">
		<li class="comment even depth-3" id="comment-39">
				<div id="div-comment-39" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="./STM32_ using the LTDC display controller – hello world_files/b97f37dc0d66752a262e119475a1b2e3.png" srcset="http://2.gravatar.com/avatar/b97f37dc0d66752a262e119475a1b2e3?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">			<cite class="fn">Bernd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/#comment-39">
			February 7, 2018 at 4:49 pm</a>		</div>

		<p>Thank you very much!</p>
<p>Adding the offset to the frambuffer base address works as expected:<br>
base address + ((start_x + start_y * DISPLAY_WIDTH) * BPP)</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-link" href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/?replytocom=39#respond" onclick="return addComment.moveForm( &quot;div-comment-39&quot;, &quot;39&quot;, &quot;respond&quot;, &quot;359&quot; )" aria-label="Reply to Bernd">Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-34">
				<div id="div-comment-34" class="comment-body">
				<div class="comment-author vcard">
			<img alt="" src="./STM32_ using the LTDC display controller – hello world_files/ed841c7dbf129814b88e2116d4a1163c.png" srcset="http://2.gravatar.com/avatar/ed841c7dbf129814b88e2116d4a1163c?s=96&amp;d=mm&amp;r=g 2x" class="avatar avatar-48 photo" height="48" width="48">			<cite class="fn">gilloup</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/#comment-34">
			January 31, 2018 at 8:39 am</a>		</div>

		<p>Excellent tutorial. It works also for me.<br>
But, as Sunnipaul, I need to add delays : with “Hal_delay(10);”  after the code line “SPI_transmit(&amp;data, 1);” ( inside the functions write_data and write_command)  , it is 0K.<br>
  Without, it doesn’t work. ..</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-link" href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/?replytocom=34#respond" onclick="return addComment.moveForm( &quot;div-comment-34&quot;, &quot;34&quot;, &quot;respond&quot;, &quot;359&quot; )" aria-label="Reply to gilloup">Reply</a></div>
				</div>
		</li><!-- #comment-## -->
			</ol><!--/.commentlist-->

			
		</div>
		
		
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/#respond" style="display:none;">Cancel reply</a></small></h3>			<form action="http://www.lucadavidian.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
				<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required="required"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" required="required"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200"></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes"><label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="359" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p>			</form>
			</div><!-- #respond -->
	
</section><!--/#comments-->          </div><!--/.pad-->
        </section><!--/.content-->
          

	<div class="sidebar s1 collapsed sticky" data-position="right" data-layout="col-2cl" data-sb-id="s1" style="transform: translateZ(0px); position: fixed; top: 0px; left: 1142.5px;">

		<a class="sidebar-toggle" title="Expand Sidebar" style="transform: translate(0px, 0px);"><i class="fa icon-sidebar-toggle"></i></a>

		<div class="sidebar-content" style="transform: translate(0px, 0px);">

			  			<div class="sidebar-top group">
                        <p>Follow:</p>
          
          <ul class="social-links"><li><a rel="nofollow" class="social-tooltip" title="Follow me on Instagram" href="https://www.instagram.com/_lucky_luke__/" target="_blank" style="color:rgba(255,255,255,0.7)"><i class="fa fa-instagram"></i></a></li><li><a rel="nofollow" class="social-tooltip" title="Follow me on Youtube" href="https://www.youtube.com/channel/UCnldsnECWuPfu5W1VkMfgDg" target="_blank" style="color:rgba(255,255,255,0.7)"><i class="fa fa-youtube"></i></a></li></ul>  			</div>
			
				<ul class="post-nav group">
		<li class="next"><a href="http://www.lucadavidian.com/2017/10/02/a-simple-game-on-stm32f429i-discovery-board/" rel="next"><i class="fa fa-chevron-right"></i><strong>Next story</strong> <span>A simple game on STM32F429I Discovery board</span></a></li>
		<li class="previous"><a href="http://www.lucadavidian.com/2017/08/12/hello-world/" rel="prev"><i class="fa fa-chevron-left"></i><strong>Previous story</strong> <span>Arduino M0 PRO: programming the core ARM Cortex-M0+ and the SAMD21 MCU</span></a></li>
	</ul>

			
					<div id="recent-posts-2" class="widget widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
											<li>
					<a href="http://www.lucadavidian.com/2018/03/08/wifi-controlled-neo-pixels-strips/">WiFi controlled Neo Pixels strips</a>
									</li>
											<li>
					<a href="http://www.lucadavidian.com/2017/11/17/stm32f4-using-the-dma-controller-with-adc/">STM32F4: using the DMA controller</a>
									</li>
											<li>
					<a href="http://www.lucadavidian.com/2017/11/15/interfacing-ps2-keyboard-to-a-microcontroller/">Interfacing a PS/2 keyboard to a microcontroller</a>
									</li>
											<li>
					<a href="http://www.lucadavidian.com/2017/10/02/a-simple-game-on-stm32f429i-discovery-board/">A simple game on STM32F429I Discovery board</a>
									</li>
											<li>
					<a href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/">STM32: using the LTDC display controller</a>
									</li>
					</ul>
		</div><div id="archives-2" class="widget widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href="http://www.lucadavidian.com/2018/03/">March 2018</a></li>
	<li><a href="http://www.lucadavidian.com/2017/11/">November 2017</a></li>
	<li><a href="http://www.lucadavidian.com/2017/10/">October 2017</a></li>
	<li><a href="http://www.lucadavidian.com/2017/08/">August 2017</a></li>
		</ul>
		</div><div id="categories-2" class="widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-4"><a href="http://www.lucadavidian.com/category/arduino/">Arduino</a>
</li>
	<li class="cat-item cat-item-3"><a href="http://www.lucadavidian.com/category/arm/">ARM</a>
</li>
	<li class="cat-item cat-item-5"><a href="http://www.lucadavidian.com/category/embedded/">embedded</a>
</li>
	<li class="cat-item cat-item-6"><a href="http://www.lucadavidian.com/category/stm32/">STM32</a>
</li>
		</ul>
</div>
		</div><!--/.sidebar-content-->

	</div><!--/.sidebar-->

	

        </div><!--/.main-inner-->
      </div><!--/.main-->
    </div><!--/.container-inner-->
  </div><!--/.container-->
    <footer id="footer">

    
    
        <section class="container" id="footer-widgets">
          <div class="container-inner">

            <div class="pad group">

                                <div class="footer-widget-1 grid one-full last">
                    <div id="quotescollection-9" class="widget widget_quotescollection"><div class="quotescollection-quote" id="w_quotescollection_9"><p>“People who think they know everything really annoy those of us who know we don’t.”</p>
<div class="attribution">—&nbsp;<cite class="author">Bjarne Stroustrup</cite></div><script type="text/javascript">
var args_w_quotescollection_9 = {"instanceID":"w_quotescollection_9", "currQuoteID":4, "showAuthor":1, "showSource":0, "tags":"", "charLimit":500, "orderBy":"random", "ajaxRefresh":1, "autoRefresh":0, "dynamicFetch":0};
<!--
document.write("<div class=\"navigation\"></a></div></div>")
//-->
</script><div class="navigation"></div></div>
</div></div>                  </div>
              
            </div><!--/.pad-->

          </section></footer></div><!--/.container-inner-->
        <!--/.container-->

    
    
    <section class="container" id="footer-bottom">
      <div class="container-inner">

        <a id="back-to-top" href="http://www.lucadavidian.com/2017/10/02/stm32-using-the-ltdc-display-controller/#"><i class="fa fa-angle-up"></i></a>

        <div class="pad group">

          <div class="grid one-half">
                                      <img id="footer-logo" src="./STM32_ using the LTDC display controller – hello world_files/cropped-mug-2.png" alt="">
            
            <div id="copyright">
                              <p>hello world © 2018. Tutti i diritti riservati.</p>
                          </div><!--/#copyright-->

            
          </div>

          <div class="grid one-half last">
                          <ul class="social-links"><li><a rel="nofollow" class="social-tooltip" title="Follow me on Instagram" href="https://www.instagram.com/_lucky_luke__/" target="_blank" style="color:rgba(255,255,255,0.7)"><i class="fa fa-instagram"></i></a></li><li><a rel="nofollow" class="social-tooltip" title="Follow me on Youtube" href="https://www.youtube.com/channel/UCnldsnECWuPfu5W1VkMfgDg" target="_blank" style="color:rgba(255,255,255,0.7)"><i class="fa fa-youtube"></i></a></li></ul>                      </div>

        </div><!--/.pad-->

      </div><!--/.container-inner-->
    </section><!--/.container-->

  <!--/#footer-->

<!--/#wrapper-->

<script type="text/javascript" src="./STM32_ using the LTDC display controller – hello world_files/underscore.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var HUParams = {"_disabled":[],"SmoothScroll":{"Enabled":true,"Options":{"touchpadSupport":false}},"centerAllImg":"1","timerOnScrollAllBrowsers":"1","extLinksStyle":"","extLinksTargetExt":"","extLinksSkipSelectors":{"classes":["btn","button"],"ids":[]},"imgSmartLoadEnabled":"","imgSmartLoadOpts":{"parentSelectors":[".container .content",".container .sidebar","#footer","#header-widgets"],"opts":{"excludeImg":[".tc-holder-img"],"fadeIn_options":100}},"goldenRatio":"1.618","gridGoldenRatioLimit":"350","sbStickyUserSettings":{"desktop":true,"mobile":false},"isWPMobile":"","menuStickyUserSettings":{"desktop":"no_stick","mobile":"stick_up"},"isDevMode":"","ajaxUrl":"http:\/\/www.lucadavidian.com\/?huajax=1","frontNonce":{"id":"HuFrontNonce","handle":"f69b316e52"},"userStarted":{"with":"with|3.3.20","on":{"date":"2017-08-08 09:45:17.000000","timezone_type":3,"timezone":"UTC"}},"isWelcomeNoteOn":"","welcomeContent":""};
/* ]]> */
</script>
<script type="text/javascript" src="./STM32_ using the LTDC display controller – hello world_files/scripts.min.js"></script>
<script type="text/javascript" src="./STM32_ using the LTDC display controller – hello world_files/comment-reply.min.js"></script>
<script type="text/javascript" src="./STM32_ using the LTDC display controller – hello world_files/wp-embed.min.js"></script>
<!--[if lt IE 9]>
<script src="http://www.lucadavidian.com/wp-content/themes/hueman/assets/front/js/ie/respond.js"></script>
<![endif]-->

</body></html>